{"version":3,"sources":["hooks/auth.hook.js","hooks/http.hook.js","hooks/message.hook.js","context/AuthContext.js","helpers.js","pages/ExpenseDetails/list.js","pages/AuthPage.js","pages/NewJourney.js","components/Loader.js","components/Modal.js","pages/NewExpense/ExpenseFormInput.js","pages/NewExpense/ExpenseDetails.js","pages/NewExpense/ExpensePayersControl.js","pages/NewExpense/ExpenseHandler.js","pages/NewExpense/ExpenseFill.js","pages/NewExpense/ExpenseUnequal.js","pages/NewExpense/index.js","pages/JourneyDetails.js","pages/ExpensesPage/List.js","pages/ExpensesPage/index.js","pages/ExpenseDetails/SettleUp.js","pages/ExpenseDetails/index.js","routes.js","App.js","serviceWorker.js","index.js"],"names":["useAuth","useState","token","setToken","ready","setReady","userId","setUserId","login","useCallback","jwtToken","id","localStorage","setItem","JSON","stringify","logout","removeItem","useEffect","data","parse","getItem","useHttp","loading","setLoading","error","setError","request","url","a","async","method","body","headers","fetch","response","json","ok","status","window","location","reload","Error","message","clearError","useMessage","toastId","text","toast","isActive","className","bodyClassName","progressClassName","noop","AuthContext","createContext","isAuthenticated","monthNamesShort","formatDate","date","part","year","Date","getFullYear","month","getMonth","formattedMonth","day","getDate","hour","getHours","minutes","getMinutes","formatMoney","amount","amoutnToString","toLocaleString","amountSplit","split","undefined","length","replace","defaultStyle","transition","height","opacity","overflow","transitionStyles","entering","entered","exiting","exited","List","items","lenders","borrowers","onOpenModal","setCurrentRepay","subCategory","setSubCategory","isShowInfo","setIsShowInfo","isBorrowers","setIsBorrowers","infoList","map","onToggleHandler","index","updateShowInfoList","item","key","onClick","name","sum","Transition","in","timeout","state","style","subItem","idx","outerItems","outerItem","subItems","getSum","event","subIndex","currentBorrower","currentLender","onPayback","AuthPage","auth","useContext","email","password","form","setForm","changeHandler","target","value","loginHandler","noValidate","autoComplete","placeholder","type","onChange","htmlFor","disabled","NewJourney","title","setTitle","history","useHistory","e","href","Authorization","push","Loader","color","width","customStyles","content","top","left","right","bottom","marginRight","ModalPanel","setAppElement","Modal","children","isOpen","onClose","onAfterCloseModal","onAfterClose","onRequestClose","contentLabel","closeTimeoutMS","bodyOpenClassName","ExpenseFormInput","onChangeTitle","onChangeAmount","inputMode","ExpensePayersControl","openEqualPayersModal","openUnequalPayersModal","payersStatus","splitStatus","ExpenseHandler","payers","expenseUsers","reduce","payersGroup","isLender","filterExpense","ExpenseFill","notPayers","setNotPayers","closeModal","setPayers","setSplitStatus","payersAmount","setPayersAmount","enteredAmount","setEnteredAmount","Object","keys","savedSum","defaultText","forEach","payer","checkSplitStatus","acc","current","onAmountFill","preventDefault","defineNotPayers","checked","amountToInt","alert","defineNotPayerQty","user","splitAmount","updatedPayers","isPayer","Math","round","defineDebt","defaultChecked","ExpenseUnequal","unequalPayers","totalBillAmount","totalPayAmount","setState","isBillData","setIsBillData","isPayData","setIsPayData","optionsList","setOptionsList","show","setShow","lenderSum","setLenderSum","selectedItems","setSelectedItems","setCurrentLender","currentLoaner","setCurrentLoaner","lendersSumList","setLendersSumList","lendersSumListInfo","setLendersSumListInfo","createUnequalPayersList","billSum","paySum","isLoaner","personalLender","createSelectOptions","all","label","updatedUnequalPayers","singleLender","loanerList","total","loaner","lenderList","lender","onPayAmountChecker","payType","isAnyPayer","some","totalAmount","onDataChange","totalSum","onSaveLenderSum","lenderAndPrice","currentLenderInfo","filter","diff","formatLenderInfo","handleClose","onSelectLender","loanerName","sumToInt","currentLenderValue","formatItems","updatedSelectedItems","find","currentLoanerInfo","lenderBillSum","extraPay","loanerDiff","predictedSum","updatedLenders","updatedLenderInfo","classNamePrefix","selected","options","billSumToInt","ifCorrectData","newPayersList","totalLenderSum","onHide","Header","closeButton","Title","Body","Footer","NewExpense","setAmount","users","setUsers","author","setAuthor","isEqualPayersModalOpen","setIsEqualPayersModalOpen","isUnequalPayersModalOpen","setIsUnequalPayersModalOpen","setPayersStatus","setLendersQty","setSinglePayer","closeEqualPayersModal","closeUnequalPayersModal","getUsers","fetched","authorData","_id","getNames","payersList","foundPayers","group","lendAmount","debtAmount","isNeedToPay","calculateSumPerPayer","to","onOpen","JourneyDetails","setUser","getAuthor","values","splice","removeUser","saveGroup","visibleExpenses","currentName","expense","dangerouslySetInnerHTML","__html","createdAt","ExpensesPage","expenses","setExpenses","setVisibleExpenses","userNames","setUserNames","setCurrentName","journey","setJourney","totalDebt","setTotalDebt","getExpensesList","userNamesList","getJourney","expensesByName","currentDebt","defaultValue","SettleUp","setBorrowers","setLenders","currentRepay","onCloseModal","settleUpInput","useRef","expenseId","useParams","borrower","setBorrower","setLender","ref","persist","inputValue","updatedDebtSum","updatedOwedSum","updatedBorrowers","repaid","payBackTo","ExpenseDetails","setExpense","isPaybackModal","setIsPaybackModal","getExpense","openPaybackModal","closePaybackModal","useRoutes","render","TransitionGroup","CSSTransition","classNames","path","exact","App","userName","routes","Provider","hideProgressBar","Boolean","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","then","registration","unregister"],"mappings":"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","file":"static/js/main.6aa40877.chunk.js","sourcesContent":["import {useState, useCallback, useEffect} from 'react'\n\nconst storageName = 'userData'\n\nexport const useAuth = () => {\n  const [token, setToken] = useState(null)\n  const [ready, setReady] = useState(false)\n  const [userId, setUserId] = useState(null)\n\n  const login = useCallback((jwtToken, id) => {\n    setToken(jwtToken)\n    setUserId(id)\n\n    localStorage.setItem(storageName, JSON.stringify({\n      userId: id, token: jwtToken\n    }))\n  }, [])\n\n\n  const logout = useCallback(() => {\n    setToken(null)\n    setUserId(null)\n    localStorage.removeItem(storageName)\n  }, [])\n\n  useEffect(() => {\n    const data = JSON.parse(localStorage.getItem(storageName))\n\n    if (data && data.token) {\n      login(data.token, data.userId)\n    }\n    setReady(true)\n  }, [login])\n\n\n  return { login, logout, token, userId, ready }\n}\n","import { useState, useCallback } from \"react\";\nimport { useAuth } from './auth.hook';\n\nexport const useHttp = () => {\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const { logout } = useAuth();\n\n  const request = useCallback(async (url, method = \"GET\", body = null, headers = {}) => {\n    setLoading(true);\n    try {\n      if (body) {\n        body = JSON.stringify(body);\n        headers[\"Content-Type\"] = \"application/json\";\n      }\n\n      const response = await fetch(url, { method, body, headers });\n      const data = await response.json();\n\n      if (!response.ok) {\n        if (response.status === 401) {\n          logout();\n          window.location.reload();\n        }\n\n        throw new Error(data.message || \"Что-то пошло не так\");\n      }\n\n      setLoading(false);\n\n      return data;\n    } catch (e) {\n      setLoading(false);\n      setError(e.message);\n      throw e;\n    }\n  }, []);\n\n  const clearError = useCallback(() => setError(null), []);\n\n  return { loading, request, error, clearError };\n};\n","import {useCallback} from 'react'\nimport { toast } from 'react-toastify';\n\nexport const useMessage = () => {\n  let toastId = null;\n\n  return useCallback((text, status='info') => {\n    if (! toast.isActive(toastId) && text) {\n      toastId = toast[status](text,{\n        className: 'notification',\n        bodyClassName: \"notification__content\",\n        progressClassName: 'notification__progressbar'\n      });\n    }\n  }, [])\n}\n","import {createContext} from 'react'\n\nfunction noop() {}\n\nexport const AuthContext = createContext({\n  token: null,\n  userId: null,\n  login: noop,\n  logout: noop,\n  isAuthenticated: false\n})\n","const monthNames = [\n  'января',\n  'февраля',\n  'марта',\n  'апреля',\n  'мая',\n  'июня',\n  'июля',\n  'августа',\n  'сентября',\n  'октября',\n  'ноября',\n  'декабря',\n];\n\nconst monthNamesShort = [\n  'янв',\n  'фев',\n  'мар',\n  'апр',\n  'мая',\n  'июн',\n  'июл',\n  'авг',\n  'сен',\n  'окт',\n  'нояб',\n  'дек',\n];\n\nexport const formatDate = (date, part = 'full') => {\n  const year = `${new Date(date).getFullYear()}`;\n\n  const month = new Date(date).getMonth();\n  const formattedMonth = monthNamesShort[month];\n\n  const day = `${new Date(date).getDate()}`;\n  // const formattedDay = day < 10 ? `0${day}` : day;\n\n  const hour = `${new Date(date).getHours()}`;\n  const formattedHours = hour < 10 ? `0${hour}` : hour;\n\n  const minutes = `${new Date(date).getMinutes()}`;\n  const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;\n\n  if (part === 'full') {\n    return `<span class=\"day\">${day}</span>\n            <span class=\"month\">${formattedMonth}</span>\n            <span class=\"year\">${year}</span>`\n  }\n\n  if (part === 'dm') {\n    return `<span class=\"day\">${day}</span><span class=\"month\">${formattedMonth}</span>`\n  }\n};\n\nexport const formatMoney = (amount) => {\n  const amountToInt = +amount;\n  const amoutnToString = amountToInt.toLocaleString('ru-RU');\n  const amountSplit = amoutnToString.split(/[,]/);\n\n  const isAddZero = amountSplit[1] !== undefined && amountSplit[1].length === 1;\n\n  return isAddZero ? `${amoutnToString.replace(',', '.')}0` : `${amoutnToString.replace(',', '.')}`;\n}","import React, { useEffect, useState } from 'react';\nimport { Transition } from 'react-transition-group';\nimport { formatMoney} from '../../helpers'\n\nconst duration = 100;\n\nconst defaultStyle = {\n  transition: `opacity ${duration}ms ease-in-out`,\n  height: 0,\n  opacity: 0,\n  overflow: 'hidden',\n};\n\nconst transitionStyles = {\n  entering: { opacity: 0, height: 0 },\n  entered: { opacity: 1, height: '100%' },\n  exiting: { opacity: 1, height: '100%' },\n  exited: { opacity: 0, height: 0 },\n};\n\nexport const List = ({ items, lenders, borrowers, onOpenModal, setCurrentRepay }) => {\n  const [subCategory, setSubCategory] = useState([]);\n  const [isShowInfo, setIsShowInfo] = useState([]);\n  const [isBorrowers, setIsBorrowers] = useState(false);\n\n\n  useEffect(() => {\n    if (lenders !== undefined && lenders.length > 0) {\n      setSubCategory([...lenders]);\n      setIsBorrowers(true);\n      return;\n    }\n\n    if (borrowers !== undefined && borrowers.length > 0) {\n      setSubCategory([...borrowers]);\n      setIsBorrowers(false);\n    }\n\n  }, [lenders, borrowers]);\n\n\n  useEffect(() => {\n    const infoList = items.map(() => {\n      return false;\n    });\n\n    setIsShowInfo([...infoList]);\n  }, [items]);\n\n  const onToggleHandler = (index) => {\n    const updateShowInfoList = [...isShowInfo];\n    updateShowInfoList[index] = !updateShowInfoList[index];\n    setIsShowInfo([...updateShowInfoList]);\n  };\n\n  const getSum = (outerItems, outerItem, subItems, subItem) => {\n    if (isBorrowers) {\n      if (subItem.sum >= outerItem.sum) {\n        return;\n      }\n\n      return subItem.sum;\n    }\n\n    if (outerItem.sum >= subItem.sum) {\n      return subItem.sum;\n    }\n\n    return outerItem.sum;\n  };\n\n  const onPayback = (event, index, subIndex) => {\n    let currentBorrower = null;\n    let currentLender = null;\n\n    if (isBorrowers) {\n      currentBorrower = items[index];\n      currentLender = subCategory[subIndex];\n    } else {\n      currentBorrower = subCategory[subIndex];\n      currentLender = items[index];\n    }\n\n    setCurrentRepay({\n      currentBorrower,\n      currentLender,\n    });\n    onOpenModal(event);\n  };\n\n  return (\n    <ul className=\"expense-details__list\">\n      {\n        items.map((item, index) => {\n          return (\n            <li\n              key={index}\n              className={`expense-details__list-item ${isShowInfo[index] ? 'expense-details__list-item--open' : ''}`}\n            >\n              <div\n                className=\"expense-details__item-outer\"\n                onClick={() => onToggleHandler(index)}\n              >\n                <div className=\"expense-details__item-name\">\n                  {item.name}\n                </div>\n                <div className=\"expense-details__item-sum\">\n                  {formatMoney(item.sum)}\n                </div>\n                <div className=\"expense-details__btn-more\">\n                  <button\n                    className=\"btn btn--text\"\n                    onClick={() => onToggleHandler(index)}\n                  >\n                    {isShowInfo[index] ? 'Скрыть' : 'Подробнее'}\n                  </button>\n                </div>\n              </div>\n              <Transition in={isShowInfo[index]} timeout={duration}>\n                {state => (\n                  <div style={{\n                    ...defaultStyle,\n                    ...transitionStyles[state]\n                  }}\n                       className=\"expense-details__item-info\"\n                  >\n                    <div\n                      className=\"expense-details__sub-list-outer\">{isBorrowers ? 'Кому вернуть:' : 'Кто одолжил:'}</div>\n                    <ul className=\"expense-details__sub-list\">\n                      {\n                        subCategory.map((subItem, idx) => {\n                          return (\n                            <li\n                              key={idx}\n                              className=\"expense-details__sub-item\"\n                            >\n                              <div className=\"expense-details__sub-item-name\">{subItem.name}</div>\n                              <div className=\"expense-details__sub-item-sum\">\n                                {getSum(items, item, subCategory, subItem)}\n                              </div>\n                              <div className=\"expense-details__btn-payback\">\n                                <button\n                                  className=\"btn btn--text\"\n                                  onClick={event => onPayback(event, index, idx)}\n                                >\n                                  Расчет\n                                </button>\n                              </div>\n                            </li>\n                          );\n                        })\n                      }\n                    </ul>\n                  </div>\n                )}\n              </Transition>\n            </li>\n          );\n        })\n      }\n    </ul>\n  );\n};","import React, { useContext, useEffect, useState } from \"react\";\nimport { useHttp } from \"../hooks/http.hook\";\nimport { useMessage } from \"../hooks/message.hook\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport { List } from './ExpenseDetails/list';\n\nexport const AuthPage = () => {\n  const auth = useContext(AuthContext);\n  const message = useMessage();\n\n  const { loading, request, error, clearError } = useHttp();\n  const [form, setForm] = useState({\n    email: \"\", password: \"\", name: \"\"\n  });\n\n  useEffect(() => {\n    message(error, 'error');\n    clearError();\n  }, [error, message, clearError]);\n\n  const changeHandler = event => {\n    setForm({ ...form, [event.target.name]: event.target.value });\n  };\n\n  const registerHandler = async () => {\n    try {\n      const data = await request(\"/api/auth/register\", \"POST\", { ...form });\n      message(data.message);\n      await loginHandler();\n    } catch (e) {\n    }\n  };\n\n  const loginHandler = async () => {\n    try {\n      const data = await request(\"/api/auth/login\", \"POST\", { ...form });\n      auth.login(data.token, data.userId);\n    } catch (e) {\n    }\n  };\n\n  return (\n    <div className=\"auth-page\">\n      <div className=\"auth-page__content\">\n        <h1 className=\"auth-page__title\">I OWE YOU</h1>\n        <form className=\"form auth-page__form\" noValidate autoComplete=\"off\">\n          <Tabs className=\"expense-details__tabs\">\n            <TabList className=\"expense-details__tabs-list\">\n              <Tab className=\"expense-details__tab\">Авторизация</Tab>\n              <Tab className=\"expense-details__tab\">Регистрация</Tab>\n            </TabList>\n\n            <TabPanel className=\"auth-page__tab-content\">\n              <div className=\"form__title\">Авторизация</div>\n              <div className=\"form__group\">\n                <div className=\"form__row\">\n                  <input\n                    placeholder=\" \"\n                    autoComplete=\"off\"\n                    id=\"email\"\n                    type=\"email\"\n                    name=\"email\"\n                    className=\"form__input\"\n                    value={ form.email }\n                    onChange={ changeHandler }\n                  />\n                  <label htmlFor=\"email\" className=\"form__label\">Email</label>\n                </div>\n                <div className=\"form__row\">\n                  <input\n                    placeholder=\" \"\n                    autoComplete=\"new-password\"\n                    id=\"password\"\n                    type=\"password\"\n                    name=\"password\"\n                    className=\"form__input\"\n                    value={ form.password }\n                    onChange={ changeHandler }\n                  />\n                  <label htmlFor=\"email\" className=\"form__label\">Пароль</label>\n                </div>\n                <div className=\"form__btn-group\">\n                  <div className=\"form__btn-row\">\n                    <button\n                      className=\"btn form__btn\"\n                      disabled={ loading }\n                      onClick={ loginHandler }\n                    >\n                      Войти\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </TabPanel>\n            <TabPanel className=\"auth-page__tab-content\">\n              <div className=\"form__title\">Регистрация</div>\n              <div className=\"form__group\">\n                <div className=\"form__row\">\n                  <input\n                    className=\"form__input\"\n                    placeholder=\" \"\n                    type=\"text\"\n                    name=\"name\"\n                    value={ form.name }\n                    onChange={changeHandler}\n                  />\n                  <label className=\"form__label\">\n                    Введите имя\n                  </label>\n                </div>\n                <div className=\"form__row\">\n                  <input\n                    placeholder=\" \"\n                    autoComplete=\"off\"\n                    id=\"email\"\n                    type=\"email\"\n                    name=\"email\"\n                    className=\"form__input\"\n                    value={ form.email }\n                    onChange={ changeHandler }\n                  />\n                  <label htmlFor=\"email\" className=\"form__label\">Email</label>\n                </div>\n                <div className=\"form__row\">\n                  <input\n                    placeholder=\" \"\n                    autoComplete=\"new-password\"\n                    id=\"password\"\n                    type=\"password\"\n                    name=\"password\"\n                    className=\"form__input\"\n                    value={ form.password }\n                    onChange={ changeHandler }\n                  />\n                  <label htmlFor=\"password\" className=\"form__label\">Пароль</label>\n                </div>\n                <div className=\"form__row\">\n                  <input\n                    placeholder=\" \"\n                    id=\"password2\"\n                    type=\"password\"\n                    name=\"password2\"\n                    className=\"form__input\"\n                  />\n                  <label htmlFor=\"password2\" className=\"form__label\">Повторите пароль</label>\n                </div>\n                <div className=\"form__btn-group\">\n                  <div className=\"form__btn-row\">\n                    <button\n                      className=\"btn form__btn\"\n                      onClick={ registerHandler }\n                      disabled={ loading }\n                    >\n                      Регистрация\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </TabPanel>\n          </Tabs>\n        </form>\n      </div>\n    </div>\n  );\n};\n","import React, { useContext, useState } from 'react';\nimport { useHttp } from '../hooks/http.hook';\nimport { AuthContext } from '../context/AuthContext';\nimport { useMessage } from \"../hooks/message.hook\";\nimport { useHistory } from \"react-router-dom\";\n\nexport const NewJourney = () => {\n  const [title, setTitle] = useState('');\n  const { request } = useHttp();\n  const { token } = useContext(AuthContext);\n  const message = useMessage();\n  const history = useHistory();\n\n  const onHandler = async event => {\n    try {\n      const data = await request('/api/journey/create', 'POST', { title }, {\n        Authorization: `Bearer ${token}`\n      });\n\n      history.push(`/journey/details`)\n      message(data.message);\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  };\n\n  return (\n    <div className=\"journey-create\">\n      <form className=\"form journey-create__form\" noValidate>\n        <h1 className=\"form__title\">Создание поездки</h1>\n        <div className=\"form__group\">\n          <div className=\"form__row\">\n            <input\n              placeholder=\" \"\n              className=\"form__input\"\n              type=\"text\"\n              value={title}\n              onChange={e => setTitle(e.target.value)}\n            />\n            <label className=\"form__label\">\n              Введите название поездки\n            </label>\n          </div>\n        </div>\n        <a href=\"#\" className=\"form__btn\" onClick={onHandler}>Сохранить</a>\n      </form>\n    </div>\n  );\n};\n","import React from 'react'\nimport LoaderSpinner from 'react-loader-spinner'\n\nexport const Loader = () => (\n  <LoaderSpinner\n    className=\"app__loader\"\n    type=\"TailSpin\"\n    color=\"#ffffff\"\n    height={100}\n    width={100}\n  />\n);\n","import React from 'react';\nimport ModalPanel from 'react-modal';\n\nconst customStyles = {\n  content : {\n    top                   : '0',\n    left                  : '0',\n    right                 : '0',\n    bottom                : '0',\n    marginRight           : '0',\n  }\n};\n\nModalPanel.setAppElement('#root');\n\nexport const Modal = ({children, isOpen, onClose, onAfterCloseModal}) => {\n\n  return (\n    <ModalPanel\n      isOpen={isOpen}\n      onAfterClose={onAfterCloseModal}\n      onRequestClose={onClose}\n      style={customStyles}\n      contentLabel=\"Example Modal\"\n      closeTimeoutMS={600}\n      className=\"app-modal\"\n      bodyOpenClassName={'body--modal-open'}\n    >\n      { children }\n    </ModalPanel>\n  );\n};\n","import React from \"react\";\n\nexport const ExpenseFormInput = ({onChangeTitle, title, onChangeAmount, amount}) => {\n\n  return (\n    <div className=\"form__group\">\n      <div className=\"form__row\">\n        <input\n          className=\"form__input\"\n          placeholder=\" \"\n          type=\"text\"\n          value={title}\n          onChange={onChangeTitle}\n        />\n        <label className=\"form__label\">\n          Введите название оплаты\n        </label>\n      </div>\n      <div className=\"form__row\">\n        <input\n          className=\"form__input\"\n          placeholder=\" \"\n          type=\"number\"\n          inputMode=\"decimal\"\n          value={amount}\n          onChange={onChangeAmount}\n        />\n        <label className=\"form__label\">\n          Введите сумму оплаты\n        </label>\n      </div>\n    </div>\n  )\n};","import React  from \"react\";\nimport { Transition } from 'react-transition-group';\n\nconst duration = 300;\n\nconst defaultStyleSinglePayer = {\n  transition: `transform ${duration}ms ease-in-out`,\n  transform: 'translateX(0)',\n};\n\nconst transitionStylesSinglePayer = {\n  entering: { transform: 'translateX(0)' },\n  entered:  { transform: 'translateX(0)' },\n  exiting:  { transform: 'translateX(-100%)' },\n  exited:   { transform: 'translateX(-100%)' },\n};\n\nconst defaultStyleMultiPayer = {\n  transition: `transform ${duration}ms ease-in-out`,\n  transform: 'translateX(-100%)',\n};\n\nconst transitionStylesMultiPayer = {\n  entering: { transform: 'translateX(0)' },\n  entered:  { transform: 'translateX(0)' },\n  exiting:  { transform: 'translateX(100%)' },\n  exited:   { transform: 'translateX(100%)' },\n};\n\nexport const ExpenseDetails = ({isSinglePayer, lendersQty, closeModal, payers, setSinglePayer, setPayers, amount}) => {\n  const splitPayers = (group, payer) => {\n    const type = payer.isLender === true ? 'lenders' : 'borrowers';\n\n    group[type] = [...group[type], payer];\n\n    return group;\n  };\n\n  const calculateSumPerPayer = (payersList) => {\n    const {lenders, borrowers} = payersList.reduce(splitPayers, {\n      lenders: [],\n      borrowers: [],\n    });\n\n    const splitAmount = +amount / payers.length;\n\n    const lendAmount = Math.round((splitAmount * borrowers.length / lenders.length) * 100) / 100;\n    const debtAmount = Math.round((lendAmount * lenders.length / borrowers.length) * 100) / 100;\n\n    return payersList.map(({name, isLender}) => {\n        return {\n          name,\n          isLender,\n          sum: isLender ? lendAmount : debtAmount,\n        }\n    });\n  };\n\n  const onPayerChanged = (event) => {\n    const updatedPayers = payers.map((payer) => ({\n      name: payer.name,\n      isLender: event.target.value === payer.name,\n      isPayer: true,\n    }));\n\n    const payersWithSum = calculateSumPerPayer(updatedPayers);\n\n    setPayers([\n      ...payersWithSum,\n    ]);\n    closeModal(event);\n  };\n\n  const onMultiplePayers = (event) => {\n    const updatedPayers = payers.map((payer) => {\n      const checkValue = () => {\n        if (payer.name === event.target.name) {\n          return event.target.checked;\n        }\n\n        return payer.isLender;\n      };\n\n      return {\n        name: payer.name,\n        isLender: checkValue(),\n        isPayer: true,\n      }\n    });\n\n    const payersWithSum = calculateSumPerPayer(updatedPayers);\n    const isAnyPayer = payersWithSum.some((payer) => payer.isLender === true);\n\n    if (isAnyPayer === false) {\n      alert('Как минимум один человек участвует в оплате');\n      return;\n    }\n\n    setPayers([\n      ...payersWithSum,\n    ]);\n  };\n\n  return (\n    <div className={`expense-payers ${lendersQty > 1 ? 'expense-payers--multi' : ''}`}>\n\n      <Transition in={isSinglePayer} timeout={duration}>\n        {state => (\n          <div className=\"expense-payers__transition\"\n               style={{\n                ...defaultStyleSinglePayer,\n                ...transitionStylesSinglePayer[state]\n              }}\n          >\n            <div className='expense-payers__single-payer'>\n              <div className=\"expense-payers__header\">\n                <div className=\"expense-payers__btn expense-payers__btn--back\">\n                  <button\n                    onClick={closeModal}\n                  >\n                    ❮\n                  </button>\n                </div>\n                <div className=\"expense-payers__title\">\n                  Выберите плательщика\n                </div>\n              </div>\n              <div className=\"expense-payers__content\">\n                <div className=\"expense-payers__list\">\n                  {\n                    payers.length && payers.map((payer, index) =>\n                      <div className=\"check-radio check-radio--row expense-payers__item\" key={payer.name}>\n                        <input type=\"radio\"\n                               id={`check-payer-${index}`}\n                               className=\"check-radio__input\"\n                               value={payer.name}\n                               checked={lendersQty === 1 && payer.isLender === true}\n                               onChange={e => onPayerChanged(e)}\n                        />\n                        <label\n                          className=\"check-radio__label\"\n                          htmlFor={`check-payer-${index}`}\n                        >\n                          {payer.name}\n                        </label>\n                      </div>\n                    )}\n                </div>\n              </div>\n              <button\n                className='expense-payers__show-multi-btn'\n                onClick={() => setSinglePayer(false)}\n              >\n                Выбрать нескольких\n              </button>\n            </div>\n          </div>\n        )}\n      </Transition>\n\n      <Transition in={!isSinglePayer} timeout={duration}>\n        {state => (\n          <div className=\"expense-payers__transition\"\n               style={{\n                ...defaultStyleMultiPayer,\n                ...transitionStylesMultiPayer[state]\n              }}\n          >\n            <div className=\"expense-payers__multiple-payers\">\n            <div className=\"header\">\n              <a className=\"header__btn-back\"\n                 onClick={() => setSinglePayer(true)}\n              >\n                <span>❮</span>\n              </a>\n              <div className=\"header__title\">Выбрать нескольких</div>\n              <a className=\"header__btn-close\"\n                 onClick={closeModal}\n              >\n                <span>×</span>\n              </a>\n            </div>\n            <div className=\"expense-payers__content\">\n              <div className=\"expense-payers__list\">\n                {\n                  payers.length && payers.map((payer, index) =>\n                    <div className=\"check-radio expense-payers__item\" key={payer.name}>\n                      <input\n                        id={`check-multi-${index}`}\n                        className=\"check-radio__input\"\n                        type=\"checkbox\"\n                        name={payer.name}\n                        checked={payer.isLender}\n                        onChange={onMultiplePayers}\n                      />\n                      <label className=\"check-radio__label\" htmlFor={`check-multi-${index}`}>\n                        {payer.name}\n                      </label>\n                    </div>\n                  )}\n              </div>\n            </div>\n          </div>\n          </div>\n        )}\n      </Transition>\n\n    </div>\n  )\n}","import React from \"react\";\n\nexport const ExpensePayersControl = ({openEqualPayersModal, openUnequalPayersModal, payersStatus, splitStatus}) => {\n  return (\n    <div className=\"new-expense__status-info\">\n      <div className=\"new-expense__block\">\n        <span>Кто платит?</span>\n        <button\n          className=\"btn btn--text new-expense__text-btn\"\n          onClick={openEqualPayersModal}\n        >\n          <span>{payersStatus}</span>\n        </button>\n      </div>\n      <div className=\"new-expense__block\">\n        <span>Как делим?</span>\n        <button\n          className=\"btn btn--text new-expense__text-btn\"\n          onClick={openUnequalPayersModal}\n        >\n          <span>{splitStatus}</span>\n        </button>\n      </div>\n    </div>\n  )\n};","import React, { useContext } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport { useHttp } from '../../hooks/http.hook';\nimport { useMessage } from '../../hooks/message.hook';\nimport { AuthContext } from '../../context/AuthContext';\n\nexport const ExpenseHandler = ({payers, title, amount}) => {\n  const { request } = useHttp();\n  const message = useMessage();\n  const { token } = useContext(AuthContext);\n  const history = useHistory();\n\n  const onHandler = async () => {\n    const expenseUsers = payers.reduce((payersGroup, {name, sum, isLender}) => {\n      const type = isLender === true ? 'lenders' : 'borrowers';\n\n      if (sum === 0) {\n        return payersGroup;\n      }\n\n      payersGroup[type] = [...payersGroup[type], {name, sum}];\n\n      return payersGroup;\n    }, {\n      lenders: [],\n      borrowers: [],\n    });\n\n    const filterExpense = () => {\n      if (expenseUsers.lenders.length === 0 || expenseUsers.borrowers.length === 0) {\n        return {\n          lenders: [],\n          borrowers: [],\n        }\n      }\n\n      return expenseUsers;\n    };\n\n    try {\n      const data = await request(\n        '/api/expense/create',\n        'POST',\n        {\n          title,\n          amount,\n          ...filterExpense(),\n        },\n        {\n          Authorization: `Bearer ${token}`\n        }\n      );\n\n      history.push(`/expense/list`)\n      message(data.message);\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  };\n\n  return (\n    <div className=\"form__btn-group\">\n      <a href=\"#\" className=\"form__btn\" onClick={onHandler}>Сохранить</a>\n    </div>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\n\nexport const ExpenseFill = ({payers, amount, notPayers, setNotPayers, closeModal, setPayers, setSplitStatus, payersAmount, setPayersAmount}) => {\n  const [enteredAmount, setEnteredAmount] = useState(0);\n\n  useEffect(() => {\n    if (Object.keys(payersAmount).length <= 0) {\n      return;\n    }\n\n    const checkSplitStatus = () => {\n      let savedSum = 0;\n      let defaultText = 'Поровну';\n\n      payers.forEach((payer, index) => {\n        if (index === 0) {\n          savedSum = payer.sum;\n        }\n\n        if ( savedSum === payer.sum) {\n          return;\n        }\n\n        defaultText = 'Не поровну';\n      });\n\n      return defaultText;\n    };\n\n    setSplitStatus(checkSplitStatus());\n  }, [payers]);\n\n  useEffect(() => {\n    const sum = Object.keys(payersAmount).reduce((acc, current) => acc + payersAmount[current], 0);\n    setEnteredAmount(sum);\n\n  }, [payersAmount]);\n\n  const onAmountFill = (event) => {\n    event.preventDefault();\n\n    setPayersAmount({\n      ...payersAmount,\n      [event.target.name]: +event.target.value\n    });\n\n  };\n\n  const saveAmount = (event) => {\n    const amountToInt = +amount;\n\n    if (enteredAmount > amountToInt) {\n      alert(`Сумма распределена неверно. Введено на ${enteredAmount - amountToInt} больше, чем общая сумма оплаты: ${amountToInt}`);\n      return;\n    }\n\n    if (enteredAmount < amountToInt) {\n      alert(`Сумма распределена неверно. Введено на ${amountToInt - enteredAmount} меньше, чем общая сумма оплаты: ${amountToInt}`);\n      return;\n    }\n\n    const defineNotPayerQty = Object.keys(notPayers).reduce((sum, user) => {\n      return sum + (+notPayers[user]);\n    }, 0);\n\n\n    const splitAmount = defineNotPayerQty > 0 ? amountToInt / (payers.length - defineNotPayerQty) : amountToInt / payers.length;\n\n    const updatedPayers = payers.map((payer) => {\n      const defineDebt = (sum = 0) => {\n        if (notPayers[payer.name] === true) {\n          if (sum === 0) {\n            return {\n              isLender: false,\n              isPayer: false,\n              sum: 0,\n            };\n          }\n\n          return {\n            isLender: true,\n            isPayer: false,\n            sum: Math.round(sum * 100) / 100,\n          }\n        }\n\n        if (sum > splitAmount) {\n          return {\n            isLender: true,\n            isPayer: true,\n            sum: Math.round((sum - splitAmount) * 100) / 100,\n          }\n        }\n\n        if (sum < splitAmount) {\n          return {\n            isLender: false,\n            isPayer: true,\n            sum: Math.round((splitAmount - sum) * 100) / 100,\n          }\n        }\n\n        return {\n          isLender: false,\n          isPayer: true,\n          sum: 0,\n        }\n      };\n\n      return {\n        ...payer,\n        ...defineDebt(payersAmount[payer.name]),\n      }\n    });\n\n    setPayers([...updatedPayers]);\n    closeModal(event);\n  };\n\n  const defineNotPayers = (event) => {\n    setNotPayers({...notPayers, [event.target.name]: !event.target.checked});\n  };\n\n  return (\n    <div className=\"expense-fill\">\n      <div className=\"header\">\n        <a className=\"header__btn-save\"\n           onClick={saveAmount}\n        >\n          <span>Сохранить</span>\n        </a>\n        <div className=\"header__title\">Укажите сумму</div>\n        <a className=\"header__btn-close\"\n           onClick={closeModal}\n        >\n          <span>×</span>\n        </a>\n      </div>\n      <div className=\"expense-fill__content\">\n        <form className=\"expense-fill__form\">\n          {\n            payers.length && payers.map((payer) =>\n              <div className=\"expense-fill__item\" key={payer.name}>\n                <span className=\"expense-fill__name\">\n                  {payer.name}\n                </span>\n                <label className=\"checkbox-switcher\">\n                  <input\n                    type=\"checkbox\"\n                    name={payer.name}\n                    defaultChecked={notPayers[payer.name] ? notPayers[payer.name] === false : true} onChange={defineNotPayers}\n                  />\n                  <span className=\"track thumb\"/>\n                </label>\n                <div className=\"expense-fill__input-row\">\n                  <span>₴</span>\n                  <input\n                    type=\"number\"\n                    inputMode=\"decimal\"\n                    placeholder=\"0.00\"\n                    name={payer.name}\n                    className=\"form__input\"\n                    value={payersAmount[payer.name] ? payersAmount[payer.name] : ''}\n                    onChange={onAmountFill}\n                  />\n                </div>\n              </div>\n            )}\n        </form>\n        <div className=\"expense-fill__footer\">\n          <div className=\"expense-fill__calculation\">\n            <div>{enteredAmount} из <span>{amount}</span></div>\n            <div>\n              Осталось:\n              <span\n                className={enteredAmount <= amount ? 'expense-fill__correct' : 'expense-fill__wrong'}>\n                      {` ${amount - enteredAmount}`}\n                    </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}","import React, { useEffect, useState } from 'react';\nimport Select from 'react-select';\nimport Modal from 'react-bootstrap/Modal'\n\nexport const ExpenseUnequal = ({ amount, payers, setPayers, closeModal }) => {\n  const [state, setState] = useState({\n    unequalPayers: [],\n    totalBillAmount: 0,\n    totalPayAmount: 0,\n  });\n\n  const [isBillData, setIsBillData] = useState(false);\n  const [isPayData, setIsPayData] = useState(false);\n\n  const [optionsList, setOptionsList] = useState([]);\n\n  const [show, setShow] = useState(false);\n  const [lenderSum, setLenderSum] = useState('');\n  const [selectedItems, setSelectedItems] = useState({});\n  const [currentLender, setCurrentLender] = useState('');\n  const [currentLoaner, setCurrentLoaner] = useState('');\n\n  const [lendersSumList, setLendersSumList] = useState({});\n  const [lendersSumListInfo, setLendersSumListInfo] = useState({});\n\n  const handleShow = () => setShow(true);\n\n  useEffect(() => {\n    const createUnequalPayersList = payers.map((payer) => {\n      return {\n        name: payer.name,\n        billSum: '',\n        paySum: '',\n        isLoaner: false,\n        personalLender: {},\n      };\n    });\n\n    if (isBillData === false) {\n      setState({\n        ...state,\n        unequalPayers: createUnequalPayersList,\n      });\n    }\n\n  }, [payers, isBillData]);\n\n  useEffect(() => {\n    if (isPayData === false) {\n      return\n    }\n\n    if (state.unequalPayers.length === 0) {\n      return;\n    }\n\n    const createSelectOptions = state.unequalPayers.reduce((all, payer) => {\n      const paySumToInt = +payer.paySum;\n      const billSumToInt = +payer.billSum;\n\n      if (paySumToInt > billSumToInt) {\n        return [\n          ...all,\n          { value: payer.name, label: payer.name }\n        ];\n      }\n\n      return all;\n    }, []);\n\n    if (createSelectOptions.length === 1) {\n      const updatedUnequalPayers = state.unequalPayers.map((payer) => {\n        const singleLender = createSelectOptions[0].value;\n\n        if (+payer.billSum > +payer.paySum) {\n          return {\n            ...payer,\n            personalLender: {\n              [singleLender]: +payer.billSum - +payer.paySum,\n            }\n          }\n        }\n\n        return payer;\n      });\n\n      setState({\n        ...state,\n        unequalPayers: updatedUnequalPayers,\n      })\n    }\n\n    setOptionsList(createSelectOptions);\n\n  }, [isPayData]);\n\n  useEffect(() => {\n    if (Object.keys(lendersSumList).length === 0) {\n      return;\n    }\n\n    const loanerList = Object.keys(lendersSumList).reduce((total, loaner) => {\n\n      const lenderList = Object.keys(lendersSumList[loaner]).map((lender) => {\n          return {name: lender, sum: lendersSumList[loaner][lender]}\n      });\n\n      return {\n        ...total,\n        [loaner]: lenderList,\n      }\n    }, {});\n\n    setLendersSumListInfo(loanerList);\n\n  }, [lendersSumList]);\n\n  const onBackHandler = () => {\n    if (isPayData === true) {\n\n      setState({\n        ...state,\n        unequalPayers: [\n          ...state.unequalPayers.map((payer) => {\n            return {\n              ...payer,\n              isLoaner: false,\n            };\n          })\n        ],\n      });\n\n      setSelectedItems({});\n\n      setIsPayData(false);\n\n      return;\n    }\n\n    setIsBillData(false);\n  };\n\n  const onPayAmountChecker = (payType) => {\n    const isAnyPayer = state.unequalPayers.some((item) => !!(+item[payType]));\n    const totalAmount = payType === 'billSum' ? state.totalBillAmount : state.totalPayAmount;\n\n    if (isAnyPayer === false) {\n      alert('Выберите как минимум одного плательщика');\n      return false;\n    }\n\n    if (totalAmount < amount) {\n      alert('Указанной суммы недостаточно, чтобы покрыть расходы');\n      return false;\n    }\n\n    if (totalAmount > amount) {\n      alert('Указанная сумма больше, чем фактическая стоимость оплаты');\n      return false;\n    }\n\n    return true;\n  };\n\n  const onBillDataHandler = () => {\n    if (onPayAmountChecker('billSum') === false) {\n      return;\n    }\n\n    setState({\n      ...state,\n      unequalPayers: state.unequalPayers.filter((item) => !!(+item.billSum)),\n    });\n    setIsBillData(true);\n  };\n\n  const onPayDataHandler = () => {\n    if (onPayAmountChecker('paySum') === false) {\n      return;\n    }\n\n    const updatedUnequalPayers = state.unequalPayers.map((payer) => {\n      const billSumToInt = +payer.billSum;\n      const paySumToInt = +payer.paySum;\n\n      if (paySumToInt < billSumToInt) {\n        return {\n          ...payer,\n          isLoaner: true,\n        };\n      }\n\n      return payer;\n    });\n\n    setState({\n      ...state,\n      unequalPayers: updatedUnequalPayers,\n    });\n\n    setIsPayData(true);\n  };\n\n  const onDataChange = (event) => {\n    const { value, name } = event.target;\n    const sum = !isBillData ? 'billSum' : 'paySum';\n    const totalAmount = !isBillData ? 'totalBillAmount' : 'totalPayAmount';\n\n    const updatedUnequalPayers = state.unequalPayers.map((payer) => {\n      if (name === payer.name) {\n        return {\n          ...payer,\n          [sum]: value,\n        };\n      }\n\n      return payer;\n    });\n\n    const totalSum = updatedUnequalPayers.reduce((all, user) => {\n      const sumToInt = +user[sum];\n\n      return all + sumToInt;\n    }, 0);\n\n    setState({\n      ...state,\n      unequalPayers: updatedUnequalPayers,\n      [totalAmount]: totalSum,\n    });\n  };\n\n  const onLenderSumChange = (event) => {\n    const {value} = event.target;\n\n    setLenderSum(value);\n  };\n\n  const onSaveLenderSum = () => {\n\n    const lenderAndPrice = {};\n    let currentLenderInfo = null;\n\n    state.unequalPayers.filter((payer) => {\n      if (payer.name === currentLender) {\n        currentLenderInfo = payer;\n      }\n\n      if (payer.isLoaner === true) {\n        Object.keys(payer.personalLender).filter((lender) => {\n          lenderAndPrice[lender] = (lenderAndPrice[lender] !== undefined) ? +lenderAndPrice[lender] + +payer.personalLender[lender] : +payer.personalLender[lender];\n        });\n\n      }\n    });\n\n    debugger\n\n\n    // if (Object.keys(lenderAndPrice).length !== 0) {\n    const diff = +currentLenderInfo.paySum - +currentLenderInfo.billSum;\n\n    if (diff < +lenderSum) {\n      alert('Недостаточно средств у заемщика, чтобы покрыть этот расход');\n      return\n    }\n\n    if (lenderAndPrice[currentLender] !== undefined && +lenderSum > +lenderAndPrice[currentLender] - diff) {\n      alert('Заемщику уже дал взаймы другому пользователю.');\n      return;\n    }\n    // }\n\n    const formatLenderInfo = {\n      [currentLoaner]: { [currentLender]: lenderSum }\n    };\n\n    setLendersSumList({\n      ...lendersSumList,\n      [currentLoaner]: {...lendersSumList[currentLoaner], ...formatLenderInfo[currentLoaner]},\n    });\n\n\n    const updatedUnequalPayers = state.unequalPayers.map((payer) => {\n      const isLoaner = formatLenderInfo[payer.name] !== undefined;\n\n      if (isLoaner) {\n        return {\n          ...payer,\n          personalLender: {\n            ...payer.personalLender,\n            ...formatLenderInfo[payer.name],\n          },\n        };\n      }\n\n      return payer;\n    });\n\n    setState({\n      ...state,\n      unequalPayers: updatedUnequalPayers,\n    });\n\n\n    handleClose();\n  };\n\n  const handleClose = () => {\n    setShow(false)\n  };\n\n  const onSelectLender = (items, loanerName) => {\n    const sumToInt = (sum) => +sum;\n    const currentLenderValue = items === null ? '' : items.value;\n\n    setCurrentLender(currentLenderValue);\n    setCurrentLoaner(loanerName);\n\n    const formatItems = [items.value];\n    const updatedSelectedItems = {\n      ...selectedItems,\n      [loanerName]: {[formatItems[0]]: 0}\n    };\n\n    setSelectedItems(updatedSelectedItems);\n\n    const savedSelectedQty = selectedItems[loanerName] === undefined ? 0 : Object.keys(selectedItems[loanerName]).length;\n    const currentSelectedQty = Object.keys(updatedSelectedItems[loanerName]).length;\n\n    if (savedSelectedQty <= currentSelectedQty ) {\n      const currentLenderInfo = state.unequalPayers.find((payer) => payer.name === currentLenderValue);\n      const currentLoanerInfo = state.unequalPayers.find((payer) => payer.name === loanerName);\n\n      const predictedSum = () => {\n        const lenderBillSum = sumToInt(currentLenderInfo.billSum);\n        const lenderPaySum = sumToInt(currentLenderInfo.paySum);\n        const loanerBillSum = sumToInt(currentLoanerInfo.billSum);\n        const loanerPaySum = sumToInt(currentLoanerInfo.paySum);\n\n        const extraPay = lenderPaySum - lenderBillSum;\n        const loanerDiff = loanerBillSum - loanerPaySum;\n\n        if (extraPay >= loanerDiff) {\n          return `${loanerDiff}`\n        }\n\n        return `${extraPay}`;\n      };\n\n      setLenderSum(predictedSum());\n\n      handleShow();\n    } else {\n      const updatedUnequalPayers = state.unequalPayers.map((payer) => {\n        const updatedLenders = {};\n\n        const updatedLenderInfo = (lenderList) => {\n          formatItems.forEach((item) => {\n            Object.keys(lenderList).forEach((subItem) => {\n              if (item === subItem) {\n                updatedLenders[subItem] = lenderList[subItem];\n              }\n            })\n          });\n\n          return updatedLenders;\n        };\n\n        if (loanerName === payer.name ) {\n          setLendersSumList({\n            ...lendersSumList,\n            [payer.name]: updatedLenderInfo(payer.personalLender),\n          });\n\n          return {\n            ...payer,\n            personalLender: updatedLenderInfo(payer.personalLender),\n          };\n        }\n\n        return payer;\n      });\n\n      setState({\n        ...state,\n        unequalPayers: updatedUnequalPayers,\n      });\n    }\n  };\n\n  const onDataSave = (event) => {\n    let ifCorrectData = true;\n    const newPayersList = state.unequalPayers;\n\n    newPayersList.forEach((payer) => {\n      debugger\n\n      if (+payer.billSum > +payer.paySum) {\n\n        const totalLenderSum = Object.keys(payer.personalLender).reduce((total, current) => {\n          return total + +payer.personalLender[current];\n        }, 0);\n\n        if (+payer.billSum !== totalLenderSum + +payer.paySum ) {\n          ifCorrectData = false;\n        }\n      }\n    });\n\n    if (ifCorrectData === false) {\n      alert('Данные о платеже введены некорректно. Попробуйте еще раз');\n      return;\n    }\n\n    const updatedPayers = newPayersList.map((payer) => {\n      return {\n        name: payer.name,\n        isLender: !payer.isLoaner,\n        isPayer: true,\n        sum: payer.isLoaner ? +payer.billSum : +payer.paySum - +payer.billSum,\n        personalLender: payer.personalLender,\n      }\n    });\n\n    setPayers(updatedPayers);\n    closeModal(event);\n  };\n\n  return (\n    <div className=\"expense-unequal\">\n      <div className=\"header\">\n        <a className=\"header__btn-save\">\n          <span>Сохранить</span>\n        </a>\n        <div className=\"header__title\">Укажите сумму</div>\n        <a className=\"header__btn-close\"\n           onClick={closeModal}\n        >\n          <span>×</span>\n        </a>\n      </div>\n\n      <div className=\"expense-unequal__hint\">\n        {isBillData === false\n          ? 'Введите сумму для каждого пользователя, указанную в чеке. Оставьте поле пустым, если пользователь не участвовал в оплате.'\n          : 'Введите сумму, которую вы готовы заплатить. Или ничего не вводите, если заплатите позже' }\n\n          <div className=\"expense-unequal__amount\">\n          <div>{isBillData === false ? state.totalBillAmount : state.totalPayAmount} из {amount}</div>\n          <div>Осталось: {amount - (isBillData === false ? state.totalBillAmount : state.totalPayAmount)}</div>\n        </div>\n      </div>\n\n      <div className=\"expense-unequal__content\">\n        {isBillData === false && <ul className=\"expense-unequal__list-bill\">\n          {\n            state.unequalPayers.map((payer, index) => {\n              return (\n                <li key={index}>\n                  <div className=\"expense-unequal__inner-panel\">\n                    <div className=\"expense-unequal__name\">{payer.name}</div>\n                    <div className=\"expense-unequal__bill-value\">\n                      <input\n                        className=\"input\"\n                        type=\"number\"\n                        placeholder=\"0.00\"\n                        name={payer.name}\n                        value={payer.billSum ? payer.billSum : ''}\n                        onChange={onDataChange}\n                      />\n                    </div>\n                  </div>\n                </li>\n              );\n            })\n          }\n        </ul>}\n\n        {isBillData === true && <ul className=\"expense-unequal__list-pay\">\n          {\n            state.unequalPayers.map((payer, index) => {\n              return (\n                <li key={index}>\n                  <div className=\"expense-unequal__inner-panel\">\n                    <div className=\"expense-unequal__name\">\n                      {payer.name}\n                    </div>\n                    <div className=\"expense-unequal__bill-sum\">Чек: {payer.billSum}</div>\n                    {isPayData === true && <span className=\"expense-unequal__pay-sum\">Оплата: </span>}\n                    <div className=\"expense-unequal__pay-value\">\n                      <input\n                        className={`input expense-unequal__input ${isPayData ? 'expense-unequal__input--disabled' : ''}`}\n                        type=\"number\"\n                        placeholder=\"0.00\"\n                        disabled={isPayData === true}\n                        name={payer.name}\n                        value={payer.paySum ? payer.paySum : ''}\n                        onChange={onDataChange}\n                      />\n                    </div>\n                  </div>\n                  <div className=\"expense-unequal__inner-panel\">\n                    {payer.isLoaner && <div className=\"expense-unequal__select-container\">\n                      {optionsList.length > 1 ? <div className=\"expense-unequal__select-box\">\n                      <Select\n                        className=\"expense-unequal__select\"\n                        classNamePrefix=\"expense-unequal-select\"\n                        placeholder=\"Кто за вас заплатит\"\n                        onChange={selected => onSelectLender(selected, payer.name)}\n                        options={optionsList}\n                      />\n                        {lendersSumListInfo[payer.name] && <span className=\"expense-unequal__lender-sum\">\n                        {\n                          lendersSumListInfo[payer.name].map((item, index) => {\n                            return (\n                              <span key={index}>\n                                  { item.name } дает взаймы { item.sum }\n                              </span>\n                            )\n                          })\n                        }\n                      </span>}\n                      </div> : <div className=\"expense-unequal__select-single\">{optionsList[0] !== undefined ? `За Вас платит: ${optionsList[0].label}` : '' }</div>}\n                    </div>}\n                  </div>\n                </li>\n              );\n            })\n          }\n        </ul>}\n      </div>\n\n      <div className=\"expense-unequal__control\">\n        {isBillData && <button\n          className=\"btn btn--text\"\n          onClick={onBackHandler}\n        >\n          Назад\n        </button>}\n\n        {!isBillData && <button\n          className=\"btn btn--text\"\n          onClick={onBillDataHandler}\n        >\n          Продолжить\n        </button>}\n\n        {isBillData && !isPayData && <button\n          className=\"btn btn--text\"\n          onClick={onPayDataHandler}\n        >\n          Продолжить\n        </button>}\n\n        {isPayData && <button\n          className=\"btn btn--text\"\n          onClick={onDataSave}\n        >\n          Сохранить\n        </button>}\n      </div>\n\n      <Modal show={show} onHide={onSaveLenderSum}>\n        <Modal.Header closeButton>\n          <Modal.Title>Укажите сумму</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <input\n            className=\"input\"\n            type=\"number\"\n            placeholder=\"0.00\"\n            value={lenderSum}\n            name=\"personal-sum\"\n            onChange={onLenderSumChange}\n          />\n        </Modal.Body>\n        <Modal.Footer>\n          <button className=\"btn btn--text\" onClick={onSaveLenderSum}>\n            Close\n          </button>\n          <button className=\"btn btn--text\" onClick={onSaveLenderSum}>\n            Save Changes\n          </button>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  );\n};\n","import React, { useCallback, useContext, useEffect, useState } from 'react';\nimport { useHttp } from '../../hooks/http.hook';\nimport { AuthContext } from '../../context/AuthContext';\nimport { useMessage } from '../../hooks/message.hook';\nimport { Loader } from \"../../components/Loader\";\nimport { Modal } from '../../components/Modal';\nimport { ExpenseDetails } from './ExpenseDetails';\nimport { ExpenseFormInput } from './ExpenseFormInput';\nimport { ExpensePayersControl } from './ExpensePayersControl';\nimport { ExpenseHandler } from './ExpenseHandler';\nimport { ExpenseFill } from './ExpenseFill';\nimport { ExpenseUnequal } from './ExpenseUnequal';\nimport { NavLink } from \"react-router-dom\";\n\nexport const NewExpense = () => {\n  const [title, setTitle] = useState('');\n  const [amount, setAmount] = useState('');\n  const [users, setUsers] = useState([]);\n  const [author, setAuthor] = useState('');\n\n  const [isEqualPayersModalOpen, setIsEqualPayersModalOpen] = useState(false);\n  const [isUnequalPayersModalOpen, setIsUnequalPayersModalOpen] = useState(false);\n\n  const [payers, setPayers] = useState([]);\n  const [payersStatus, setPayersStatus] = useState('');\n  const [splitStatus, setSplitStatus] = useState('Поровну');\n  const [lendersQty, setLendersQty] = useState(0);\n  const [payersAmount, setPayersAmount] = useState({});\n  const [notPayers, setNotPayers] = useState({});\n\n  const [isSinglePayer, setSinglePayer] = useState(true);\n\n  const { request, loading } = useHttp();\n  const { token, userId } = useContext(AuthContext);\n  const message = useMessage();\n\n  const openEqualPayersModal = (e) => {\n    e.preventDefault();\n    if (amount <= 0) {\n      message('Введите сумму оплаты', 'info');\n      return;\n    }\n\n    setIsEqualPayersModalOpen(true);\n  };\n\n  const openUnequalPayersModal = (e) => {\n    e.preventDefault();\n    if (amount <= 0) {\n      message('Введите сумму оплаты', 'info');\n      return;\n    }\n\n    setIsUnequalPayersModalOpen(true);\n  };\n\n  const closeEqualPayersModal = (e) => {\n    e.preventDefault();\n    setIsEqualPayersModalOpen(false);\n  };\n\n  const closeUnequalPayersModal = (e) => {\n    e.preventDefault();\n    setIsUnequalPayersModalOpen(false);\n  };\n\n  const getUsers = useCallback(async () => {\n    try {\n      const fetched = await request('/api/users', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      setUsers(fetched);\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  }, [token, request]);\n\n  useEffect(() => {\n    getUsers();\n  }, []);\n\n  useEffect(() => {\n    if (users.length <= 0) {\n      return;\n    }\n\n    const authorData = users.find((user) => {\n      return user._id === userId;\n    });\n\n    if (authorData) {\n      setAuthor(authorData.name);\n      setPayersStatus(authorData.name);\n    }\n\n  }, [users]);\n\n\n  useEffect(() => {\n    if (users.length <= 0) {\n      return;\n    }\n\n    const getNames = users.reduce((acc, user) => {\n      acc = {...acc, [user.name]: false};\n      return acc;\n    }, {});\n\n    setNotPayers({...getNames})\n  }, [users]);\n\n  useEffect(() => {\n    const payersList = users.map((user) => {\n      return {\n        name: user.name,\n        isLender: user.name === author,\n        sum: 0,\n      };\n    });\n\n    setPayers([...payersList]);\n  }, [users, author]);\n\n  useEffect(() => {\n    if (payers.length <= 0) {\n      return;\n    }\n\n    const foundPayers = payers.filter((payer) => {\n      return payer.isLender;\n    });\n\n    // const payersQty = payers.reduce((total, payer) => {\n    //   if (payer.sum > 0) {\n    //     return total + 1;\n    //   }\n    //\n    //   return 0;\n    // }, 0);\n\n    if (foundPayers.length <= 0) {\n      return;\n    }\n\n    const payerStatus = () => {\n      if (foundPayers.length > 1) {\n        return `${foundPayers.length} чел.`;\n      }\n\n      if (foundPayers[0].name === author) {\n        return `${foundPayers[0].name}(Вы)`;\n      }\n\n      return foundPayers[0].name;\n    };\n\n    setPayersStatus(payerStatus());\n    setLendersQty(foundPayers.length);\n\n  }, [payers, notPayers]);\n\n  const calculateSumPerPayer = (payersList) => {\n    const splitAmount = +amount / payers.length;\n\n    const splitPayers = (group, payer) => {\n      const type = payer.isLender === true ? 'lenders' : 'borrowers';\n\n      group[type] = [...group[type], payer];\n\n      return group;\n    };\n\n    const { lenders, borrowers } = payersList.reduce(splitPayers, {\n      lenders: [],\n      borrowers: [],\n    });\n\n    const lendAmount = Math.round((splitAmount * borrowers.length / lenders.length) * 100) / 100;\n    const debtAmount = Math.round((lendAmount * lenders.length / borrowers.length) * 100) / 100;\n\n    return payersList.map(({ name, isLender }) => {\n      const isNeedToPay = isLender && splitAmount <= lendAmount;\n\n      return {\n        name,\n        isLender: isNeedToPay,\n        sum: isNeedToPay ? lendAmount : debtAmount,\n      };\n    });\n  };\n\n  useEffect(() => {\n    setPayers([...calculateSumPerPayer(payers)]);\n  }, [amount]);\n\n  if (loading) {\n    return <Loader/>;\n  }\n\n  return (\n    <div className=\"new-expense\">\n      <div className=\"header\">\n        <NavLink\n          className=\"header__btn-back\"\n          to=\"/expense/list\"\n        >\n          <span>❮</span>\n        </NavLink>\n        <div className=\"header__title\">\n          Выберите плательщика\n        </div>\n      </div>\n      <form className=\"new-expense__form form\">\n        <div className=\"form__title\">Укажите название и сумму новой оплаты:</div>\n        <ExpenseFormInput\n          title={title}\n          amount={amount}\n          onChangeTitle={e => setTitle(e.target.value)}\n          onChangeAmount={e => setAmount(e.target.value)}\n        />\n\n        <ExpensePayersControl\n          openEqualPayersModal={openEqualPayersModal}\n          openUnequalPayersModal={openUnequalPayersModal}\n          payersStatus={payersStatus}\n          splitStatus={splitStatus}\n        />\n\n        <ExpenseHandler\n          payers={payers}\n          title={title}\n          amount={amount}\n        />\n      </form>\n\n      <Modal\n        onOpen={openEqualPayersModal}\n        onClose={closeEqualPayersModal}\n        isOpen={isEqualPayersModalOpen}\n        onAfterCloseModal={() => setSinglePayer(true)}\n      >\n        {/*<ExpenseDetails*/}\n        {/*  payers={payers}*/}\n        {/*  amount={amount}*/}\n        {/*  isSinglePayer={isSinglePayer}*/}\n        {/*  lendersQty={lendersQty}*/}\n        {/*  setSinglePayer={setSinglePayer}*/}\n        {/*  setPayers={setPayers}*/}\n        {/*  closeModal={closeEqualPayersModal}*/}\n        {/*/>*/}\n        <ExpenseUnequal\n          amount={amount}\n          payers={payers}\n          setPayers={setPayers}\n          closeModal={closeEqualPayersModal}\n        />\n      </Modal>\n\n      <Modal\n        onOpen={openUnequalPayersModal}\n        onClose={closeUnequalPayersModal}\n        isOpen={isUnequalPayersModalOpen}\n      >\n        <ExpenseFill\n          payers={payers}\n          notPayers={notPayers}\n          amount={amount}\n          payersAmount={payersAmount}\n          setPayers={setPayers}\n          setNotPayers={setNotPayers}\n          setPayersAmount={setPayersAmount}\n          setSplitStatus={setSplitStatus}\n          closeModal={closeUnequalPayersModal}\n        />\n      </Modal>\n    </div>\n  );\n};\n","import React, { useCallback, useContext, useEffect, useState } from \"react\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport { useHttp } from \"../hooks/http.hook\";\nimport { Loader } from \"../components/Loader\";\nimport { useMessage } from \"../hooks/message.hook\";\nimport { useHistory } from \"react-router-dom\";\n\nexport const JourneyDetails = () => {\n  let [users, setUsers] = useState([]);\n  let [user, setUser] = useState('');\n  let [author, setAuthor] = useState('');\n  const history = useHistory();\n  const message = useMessage();\n\n  const { token } = useContext(AuthContext);\n  const { loading, request } = useHttp();\n\n  const getAuthor = useCallback(async () => {\n    try {\n      const fetched = await request('/api/users/author', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      // setUsers([...users, fetched]);\n      setAuthor(fetched);\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  }, [token, request]);\n\n  useEffect(() => {\n    getAuthor();\n  }, [getAuthor]);\n\n  const changeHandler = (event, index) => {\n    event.preventDefault();\n    setUser(event.target.value);\n  };\n\n  const addUser = (event) => {\n    event.preventDefault();\n\n    if (user.length <= 0) {\n      message('Введите имя', 'error');\n      return;\n    }\n\n    setUsers([...users, user]);\n    setUser('');\n  };\n\n  const removeUser = (index) => {\n    const values = [...users];\n    values.splice(index, 1);\n    setUsers(values);\n  };\n\n  const saveGroup = async (e) => {\n    e.preventDefault();\n\n    try {\n      const data = await request(\"/api/journey/users/add\", \"POST\", { users }, {\n        Authorization: `Bearer ${token}`,\n      });\n\n      message(data.message);\n      history.push(`/expense`)\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  };\n\n  if (loading) {\n    return <Loader/>;\n  }\n\n  return (\n    <div className=\"journey-details\">\n        <div className=\"journey-details__content\">\n          <h1 className=\"journey-details__title\">Добавление участников</h1>\n          <form noValidate className=\"form journey-details__form\">\n            <div className=\"form__title\">Здесь мы добавим всех участников между которыми делим средства</div>\n            <ul className=\"journey-details__user-list\">\n              {author && <li className=\"journey-details__user\">\n                <span>👑 { author }</span>\n              </li>}\n              {\n                users.length > 0 && users.map((item, index) =>\n                  <li key={index} className=\"journey-details__user\">\n                    <span className=\"journey-details__user-name\">{ item }</span>\n                    {\n                      <a className=\"journey-details__user-remove\"\n                         href=\"#\"\n                         onClick={() => removeUser(index)}\n                      >✖︎</a>\n                    }\n                  </li>,\n                )\n              }\n            </ul>\n            <div className=\"form__row\">\n              <input\n                placeholder=\" \"\n                type=\"text\"\n                value={user}\n                className=\"form__input\"\n                onChange={e => changeHandler(e)}\n              />\n              <label className=\"form__label\">Введите имя</label>\n            </div>\n            <div className=\"form__btn-group\">\n              <div className=\"form__btn-row\">\n                <button\n                  className=\"form__btn form__btn--white \"\n                  onClick={e => addUser(e)}\n                >\n                  Добавить\n                </button>\n              </div>\n              <div className=\"form__btn-row\">\n                <button\n                  className=\"form__btn\"\n                  onClick={e => saveGroup(e)}\n                  disabled={users.length <= 0}\n                >\n                  Сохранить\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport { formatDate, formatMoney } from \"../../helpers\";\nimport { NavLink, useHistory } from 'react-router-dom';\n\nexport const List = ({ visibleExpenses, currentName }) => {\n\n\n  const getSum = (borrowers) => {\n    return borrowers.reduce((sum, current) => {\n      if (currentName === 'all') {\n        return sum + current.sum;\n      }\n\n      if (current.name === currentName) {\n        return sum + current.sum;\n      }\n\n      return sum;\n    }, 0);\n  };\n\n  return (\n    <ul className=\"expenses-page__list\">\n      {\n        visibleExpenses.map((expense) => {\n          return (\n            <li key={expense._id} className=\"expenses-page__list-item\">\n              <NavLink to={`/expense/${expense._id}`} className=\"expenses-page__item-content\">\n                <div className=\"expenses-page__item-time\"\n                     dangerouslySetInnerHTML={{ __html: formatDate(expense.createdAt, 'dm') }}\n                />\n                <div className=\"expenses-page__item-info\">\n                  <div className=\"expenses-page__info-top\">\n                    <div className=\"expenses-page__item-title\"><span>{expense.title}</span></div>\n                    <div className=\"expenses-page__item-amount\">Долг: {formatMoney(getSum(expense.borrowers))}</div>\n                  </div>\n                  <div className=\"expenses-page__info-bottom\">\n                    Сумма оплаты: {formatMoney(expense.amount)}\n                  </div>\n                </div>\n                <div className=\"expenses-page__item-open\">\n                  ❯\n                </div>\n              </NavLink>\n            </li>\n          );\n        })\n      }\n    </ul>\n  );\n};","import React, { useCallback, useContext, useEffect, useState } from 'react';\n// import { useParams } from 'react-router-dom';\nimport { AuthContext } from '../../context/AuthContext';\nimport { useHttp } from '../../hooks/http.hook';\nimport { useMessage } from '../../hooks/message.hook';\nimport { Loader } from '../../components/Loader';\nimport { NavLink, useHistory } from 'react-router-dom';\nimport { List } from './List';\nimport { formatDate, formatMoney } from '../../helpers';\n\nexport const ExpensesPage = () => {\n  const { token, logout } = useContext(AuthContext);\n  const { request, loading } = useHttp();\n  const [expenses, setExpenses] = useState([]);\n  const [visibleExpenses, setVisibleExpenses] = useState([]);\n  const [userNames, setUserNames] = useState([]);\n  const [currentName, setCurrentName] = useState('all');\n  const [journey, setJourney] = useState({});\n  const [totalDebt, setTotalDebt] = useState(0);\n\n  const message = useMessage();\n  const history = useHistory();\n\n  const getExpensesList = useCallback(async () => {\n    try {\n      const fetched = await request('/api/expense/list', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      setExpenses([...fetched]);\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  }, [token, request]);\n\n  const getUsers = useCallback(async () => {\n    try {\n      const fetched = await request('/api/users', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      const userNamesList = fetched.map((user) => {\n        return user.name;\n      });\n\n      setUserNames([...userNamesList]);\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  }, [token, request]);\n\n  const getJourney = useCallback(async () => {\n    try {\n      const fetched = await request('/api/journey', 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      if (fetched === null) {\n        history.push(`/journey`)\n      }\n\n      setJourney({ ...fetched });\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  }, [token, request]);\n\n  useEffect(() => {\n    getJourney();\n  }, [getJourney]);\n\n  useEffect(() => {\n    getExpensesList();\n  }, [getExpensesList]);\n\n  useEffect(() => {\n    getUsers();\n  }, [getUsers]);\n\n  useEffect(() => {\n    if (expenses.length <= 0) {\n      return;\n    }\n\n    const visibleExpenses = expenses.filter((expense) => {\n      return expense.borrowers.length > 0;\n    });\n\n    if (currentName === 'all') {\n      setVisibleExpenses([...visibleExpenses]);\n      return;\n    }\n\n    const expensesByName = visibleExpenses.filter((expense) => {\n      return expense.borrowers.some((item) => item.name === currentName);\n    });\n\n    setVisibleExpenses([...expensesByName]);\n\n\n  }, [expenses, currentName]);\n\n  useEffect(() => {\n    if (expenses.length <= 0) {\n      return;\n    }\n\n    const currentUserDebt = (user) => {\n      return user.name === currentName ? user.sum : 0;\n    };\n\n    const totalDebt = expenses.reduce((total, current) => {\n      return total + current.borrowers.reduce((totalDebt, currentDebt) => {\n        return totalDebt + (currentName === 'all' ? currentDebt.sum : currentUserDebt(currentDebt));\n      }, 0);\n    }, 0);\n\n    setTotalDebt(totalDebt);\n\n  }, [expenses, currentName]);\n\n  const getCurrentExpenses = (event) => {\n    setCurrentName(event.target.value);\n  };\n\n  const logoutHandler = event => {\n    event.preventDefault();\n    logout();\n    history.push('/');\n  };\n\n  if (loading) {\n    return <Loader/>;\n  }\n\n  return (\n    <div className=\"expenses-page\">\n      <div className=\"header\">\n        <div className=\"header__title\">Список оплат</div>\n        <a className=\"header__btn-exit\"\n           href=\"/\"\n           onClick={logoutHandler}\n        >\n          <span>Выйти</span>\n        </a>\n      </div>\n      <div className=\"expenses-page__brief\">\n        <div className=\"expenses-page__journey-title\">{journey.title}</div>\n        <div className=\"expenses-page__expense-info\">\n          <div className=\"expenses-page__journey-date\">\n            <span className=\"date\" dangerouslySetInnerHTML={{ __html: formatDate(journey.createdAt) }}/>\n          </div>\n          <span className=\"expenses-page__separator\">•</span>\n          <div className=\"expenses-page__users-qty\">\n            <span>{userNames.length} чел</span>\n          </div>\n        </div>\n        {totalDebt > 0 && <div className=\"expenses-page__summary-debt\">\n          {`Сумма долга (${currentName === 'all' ? 'общая' : currentName}):`}<span>{formatMoney(totalDebt)}</span>\n        </div> }\n      </div>\n      <div className=\"expenses-page__header\">\n        <div className=\"expenses-page__select-box\">\n          <select onChange={getCurrentExpenses}>\n            <option defaultValue value=\"all\">Все расходы</option>\n            {\n              userNames.map((name, idx) => {\n                return (\n                  <option key={idx} value={name}>Расходы {name}</option>\n                );\n              })\n            }\n          </select>\n        </div>\n        <div className=\"expenses-page__add-expense\">\n          <NavLink\n            className=\"btn btn--text\"\n            to=\"/expense/create\"\n          >\n            <span>+</span>\n          </NavLink>\n        </div>\n      </div>\n      <div className=\"expenses-page__body\">\n        {visibleExpenses.length > 0 && <List\n          visibleExpenses={visibleExpenses}\n          currentName={currentName}\n        />}\n\n        {visibleExpenses.length === 0 && <div className=\"expenses-page__empty-list\">\n          <div className=\"expenses-page__empty-info\">\n            <div className=\"expenses-page__empty-notice\">\n              <p>Здесь отображается <br/>список ваших оплат.</p>\n              <p>Для создания новой оплаты, <br/>нажмите на <span>+</span></p>\n            </div>\n            <div className=\"expenses-page__angle-arrow\">↴</div>\n          </div>\n\n        </div>}\n      </div>\n    </div>\n  );\n};\n","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { useHttp } from '../../hooks/http.hook';\nimport { useMessage } from '../../hooks/message.hook';\nimport { AuthContext } from '../../context/AuthContext';\n\nexport const SettleUp = ({ borrowers, lenders, setBorrowers, setLenders, currentRepay, onCloseModal }) => {\n  const { request, loading } = useHttp();\n  const { token } = useContext(AuthContext);\n  const message = useMessage();\n  const settleUpInput = useRef(null);\n\n  const history = useHistory();\n  const expenseId = useParams().id;\n  const [borrower, setBorrower] = useState({});\n  const [lender, setLender] = useState({});\n\n  useEffect(() => {\n    if ((currentRepay) === null) {\n      return;\n    }\n\n    setBorrower(currentRepay.currentBorrower);\n    setLender(currentRepay.currentLender);\n  }, [currentRepay]);\n\n  useEffect(() => {\n    if (borrower.sum === undefined) {\n      return;\n    }\n\n    settleUpInput.current.value = lender.sum >= borrower.sum ? borrower.sum : lender.sum;\n  }, [borrower]);\n\n  const onPaybackHandler = async (event) => {\n    event.persist();\n    const inputValue = +settleUpInput.current.value;\n\n    if (+inputValue > +borrower.sum) {\n      alert(`Введенная сумма больше требуемой - ${borrower.sum}`)\n      return;\n    }\n\n    const updatedDebtSum = borrower.sum - inputValue;\n    const updatedOwedSum = lender.sum - inputValue;\n\n    const updatedBorrowers = borrowers.reduce((acc, user) => {\n      if (user.name === borrower.name) {\n        if (updatedDebtSum > 0) {\n          return [...acc, {\n            ...user,\n            sum: updatedDebtSum,\n          }];\n        }\n\n        return acc;\n      }\n\n      return [...acc, user];\n    }, []);\n\n    const updatedLenders = lenders.reduce((acc, user) => {\n      if (user.name === lender.name) {\n        if (updatedOwedSum > 0) {\n          return [...acc, {\n            ...user,\n            sum: updatedOwedSum,\n          }];\n        }\n\n        return acc;\n      }\n\n      return [...acc, user];\n    }, []);\n\n    try {\n      const data = await request(\n        `/api/expense/update/${expenseId}`,\n        'POST',\n        {\n          borrowers: [...updatedBorrowers],\n          lenders: [...updatedLenders],\n          repaid: [\n            { name: borrower.name, sum: settleUpInput.current.value, payBackTo: lender.name },\n          ],\n        },\n        {\n          Authorization: `Bearer ${token}`\n        }\n      );\n\n      // history.push(`/expense/list`);\n      // message(data.message);\n      setBorrowers([...updatedBorrowers]);\n      setLenders([...updatedLenders]);\n      onCloseModal(event);\n\n    } catch (e) {\n      message(e.message, 'error');\n    }\n  };\n\n  // if (loading) {\n  //   return <Loader/>;\n  // }\n\n  return currentRepay && (\n    <div className=\"settle-up\">\n      <div className=\"settle-up__header\">\n        <div className=\"settle-up__back-btn\">\n          <a onClick={onCloseModal}>\n            <span>❮</span>\n          </a>\n        </div>\n        <div className=\"settle-up__title\">Детали оплаты</div>\n      </div>\n      <div className=\"settle-up__content\">\n        <div className=\"settle-up__payback-status\">\n          <p>\n            Пользователь <span>{borrower.name}</span> возвращает средства пользователю <span>{lender.name}</span>.\n          </p>\n          <p>Отредактируйте сумму при необходимости.</p>\n        </div>\n        <div className=\"settle-up__payback-widget\">\n          <div className=\"settle-up__payback-process\">\n            <div className=\"settle-up__payback-from\">\n              {borrower.name}\n            </div>\n            <div className=\"settle-up__payback-arrow\">⟶</div>\n            <div className=\"settle-up__payback-to\">\n              {lender.name}\n            </div>\n          </div>\n          <div className=\"form settle-up__payback-sum\">\n            <input\n              className=\"form__input\"\n              type=\"number\"\n              inputMode=\"decimal\"\n              placeholder=\"0.00\"\n              ref={settleUpInput}\n            />\n          </div>\n          <div className=\"settle-up__btn-apply\">\n            <button\n              className=\"btn btn--text\"\n              onClick={onPaybackHandler}\n            >\n              Подвердить\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React, { useCallback, useContext, useState, useEffect } from 'react';\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport { NavLink, useHistory, useParams } from 'react-router-dom';\nimport { useHttp } from '../../hooks/http.hook';\nimport { AuthContext } from '../../context/AuthContext';\nimport { Loader } from '../../components/Loader';\nimport { List } from './list';\nimport { formatDate } from \"../../helpers\";\nimport { Modal } from \"../../components/Modal\";\nimport { SettleUp } from './SettleUp'\n\nexport const ExpenseDetails = () => {\n  const { token } = useContext(AuthContext);\n  const { request, loading } = useHttp();\n  const expenseId = useParams().id;\n  const history = useHistory();\n\n  const [expense, setExpense] = useState(null);\n  const [borrowers, setBorrowers] = useState([]);\n  const [lenders, setLenders] = useState([]);\n\n  const [currentRepay, setCurrentRepay] = useState(null);\n\n  const [isPaybackModal, setIsPaybackModal] = useState(false);\n\n  const getExpense = useCallback(async () => {\n    try {\n      const fetched = await request(`/api/expense/${expenseId}`, 'GET', null, {\n        Authorization: `Bearer ${token}`\n      });\n\n      if (fetched.borrowers.length === 0) {\n        history.push('/expense/list');\n        return;\n      }\n\n      setExpense(fetched);\n    } catch (e) {\n      history.push('/expense/list');\n    }\n  }, [token, expenseId, request]);\n\n  useEffect(() => {\n    getExpense();\n  }, [getExpense]);\n\n  useEffect(() => {\n    if (expense === null) {\n      return;\n    }\n\n    setBorrowers([...expense.borrowers]);\n    setLenders([...expense.lenders]);\n\n  }, [expense]);\n\n  const openPaybackModal = (event) => {\n    event.preventDefault();\n\n    setIsPaybackModal(true);\n  };\n\n  const closePaybackModal = (event) => {\n    event.preventDefault();\n\n    setIsPaybackModal(false);\n  };\n\n  const checkExpense = () => {\n    if (borrowers.length !== 0) {\n      return;\n    }\n\n    history.push('/expense/list');\n  };\n\n  if (loading) {\n    return <Loader/>;\n  }\n\n  return expense && (\n    <div className=\"expense-details\">\n      <div className=\"header\">\n        <NavLink className=\"header__btn-back\"\n                 to=\"/expense/list\">\n          <span>❮</span>\n        </NavLink>\n        <div className=\"header__title\">\n          Детали оплаты\n        </div>\n      </div>\n      <div className=\"expense-details__brief\">\n        <div className=\"expense-details__expense-title\">\n          {expense.title}\n        </div>\n        <div className=\"expense-details__expense-amount\">\n          Стоимость: <span>{expense.amount}</span>\n        </div>\n        <div className=\"expense-details__expense-date\">\n          Дата создания: <span dangerouslySetInnerHTML={{ __html: formatDate(expense.createdAt) }}/>\n        </div>\n      </div>\n      <div className=\"expense-details__content\">\n        <Tabs className=\"expense-details__tabs\">\n          <TabList className=\"expense-details__tabs-list\">\n            <Tab className=\"expense-details__tab\">Недоплатили</Tab>\n            <Tab className=\"expense-details__tab\">Переплатили</Tab>\n          </TabList>\n\n          <TabPanel className=\"expense-details__tab-content\">\n            <List\n              items={borrowers}\n              lenders={lenders}\n              onOpenModal={openPaybackModal}\n              setCurrentRepay={setCurrentRepay}\n            />\n          </TabPanel>\n          <TabPanel className=\"expense-details__tab-content\">\n            <List\n              items={lenders}\n              borrowers={borrowers}\n              onOpenModal={openPaybackModal}\n              setCurrentRepay={setCurrentRepay}\n            />\n          </TabPanel>\n        </Tabs>\n      </div>\n\n      <Modal\n        onOpen={openPaybackModal}\n        onClose={closePaybackModal}\n        onAfterCloseModal={checkExpense}\n        isOpen={isPaybackModal}\n      >\n        <SettleUp\n          expense={expense}\n          borrowers={borrowers}\n          lenders={lenders}\n          setBorrowers={setBorrowers}\n          setLenders={setLenders}\n          currentRepay={currentRepay}\n          onCloseModal={closePaybackModal}\n        />\n      </Modal>\n    </div>\n  );\n};","import React from 'react'\nimport { Redirect, Route, Switch } from 'react-router-dom'\nimport {\n  TransitionGroup,\n  CSSTransition\n} from \"react-transition-group\";\n\nimport { AuthPage } from './pages/AuthPage';\nimport { NewJourney } from './pages/NewJourney';\nimport { NewExpense } from './pages/NewExpense';\nimport { JourneyDetails } from './pages/JourneyDetails';\nimport { ExpensesPage } from './pages/ExpensesPage';\nimport { ExpenseDetails } from './pages/ExpenseDetails';\n\nexport const useRoutes = isAuthenticated => {\n  if (isAuthenticated) {\n    return (\n      <Route render={({ location }) => (\n        <TransitionGroup className=\"app__switcher\">\n          <CSSTransition\n            key={location.key}\n            classNames=\"app__page-\"\n            timeout={300}\n          >\n          <Switch location={location}>\n            <Route path=\"/journey\" exact>\n              <NewJourney/>\n            </Route>\n            <Route path=\"/expense/create\" exact>\n              <NewExpense/>\n            </Route>\n            <Route path=\"/journey/details\" exact>\n              <JourneyDetails/>\n            </Route>\n            <Route path=\"/expense/list\" exact>\n              <ExpensesPage/>\n            </Route>\n            <Route path=\"/expense/:id\">\n              <ExpenseDetails/>\n            </Route>\n            <Redirect to=\"/expense/list\"/>\n          </Switch>\n          </CSSTransition>\n        </TransitionGroup>\n      )}/>\n    )\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" exact>\n        <AuthPage/>\n      </Route>\n      <Redirect to=\"/\"/>\n    </Switch>\n  )\n}\n","import React from 'react';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport { useRoutes } from './routes';\nimport { useAuth } from './hooks/auth.hook';\nimport { AuthContext } from './context/AuthContext';\nimport { Navbar } from './components/Navbar';\nimport { Loader } from './components/Loader';\nimport { ToastContainer, toast } from 'react-toastify';\n\nfunction App() {\n  const { token, login, logout, userId, ready, userName } = useAuth();\n  const isAuthenticated = !!token;\n  const routes = useRoutes(isAuthenticated);\n\n  if (!ready) {\n    return <Loader/>;\n  }\n\n  return (\n    <>\n      <AuthContext.Provider value={{\n        token, login, logout, userId, isAuthenticated, userName,\n      }}>\n        <Router>\n            {/*{isAuthenticated && <Navbar/>}*/}\n            <div className=\"app__body\">\n              {routes}\n            </div>\n        </Router>\n      </AuthContext.Provider>\n      <ToastContainer hideProgressBar/>\n    </>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './scss/index.scss';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App/>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}