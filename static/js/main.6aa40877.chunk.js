(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{41:function(e,a,t){e.exports=t(81)},46:function(e,a,t){},81:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(12),c=t.n(l),s=(t(46),t(10)),u=t(16),o=t(82),m=t(83),i=t(6),p=t.n(i),b=t(11),d=t(4),f=t(2),_=function(){var e=Object(n.useState)(null),a=Object(f.a)(e,2),t=a[0],r=a[1],l=Object(n.useState)(!1),c=Object(f.a)(l,2),s=c[0],u=c[1],o=Object(n.useState)(null),m=Object(f.a)(o,2),i=m[0],p=m[1],b=Object(n.useCallback)((function(e,a){r(e),p(a),localStorage.setItem("userData",JSON.stringify({userId:a,token:e}))}),[]),d=Object(n.useCallback)((function(){r(null),p(null),localStorage.removeItem("userData")}),[]);return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&b(e.token,e.userId),u(!0)}),[b]),{login:b,logout:d,token:t,userId:i,ready:s}},E=function(){var e=Object(n.useState)(!1),a=Object(f.a)(e,2),t=a[0],r=a[1],l=Object(n.useState)(null),c=Object(f.a)(l,2),s=c[0],u=c[1],o=_().logout;return{loading:t,request:Object(n.useCallback)((function(e){var a,t,n,l,c,s=arguments;return p.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:"GET",t=s.length>2&&void 0!==s[2]?s[2]:null,n=s.length>3&&void 0!==s[3]?s[3]:{},r(!0),m.prev=4,t&&(t=JSON.stringify(t),n["Content-Type"]="application/json"),m.next=8,p.a.awrap(fetch(e,{method:a,body:t,headers:n}));case 8:return l=m.sent,m.next=11,p.a.awrap(l.json());case 11:if(c=m.sent,l.ok){m.next=15;break}throw 401===l.status&&(o(),window.location.reload()),new Error(c.message||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 15:return r(!1),m.abrupt("return",c);case 19:throw m.prev=19,m.t0=m.catch(4),r(!1),u(m.t0.message),m.t0;case 24:case"end":return m.stop()}}),null,null,[[4,19]])}),[]),error:s,clearError:Object(n.useCallback)((function(){return u(null)}),[])}},v=t(20),O=function(){var e=null;return Object(n.useCallback)((function(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";!v.b.isActive(e)&&a&&(e=v.b[t](a,{className:"notification",bodyClassName:"notification__content",progressClassName:"notification__progressbar"}))}),[])};function j(){}var h=Object(n.createContext)({token:null,userId:null,login:j,logout:j,isAuthenticated:!1}),N=t(13),x=t(5),g=t(18),y=["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u044f","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f\u0431","\u0434\u0435\u043a"],w=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full",t="".concat(new Date(e).getFullYear()),n=new Date(e).getMonth(),r=y[n],l="".concat(new Date(e).getDate()),c="".concat(new Date(e).getHours()),s=(c<10&&"0".concat(c),"".concat(new Date(e).getMinutes()));s<10&&"0".concat(s);return"full"===a?'<span class="day">'.concat(l,'</span>\n            <span class="month">').concat(r,'</span>\n            <span class="year">').concat(t,"</span>"):"dm"===a?'<span class="day">'.concat(l,'</span><span class="month">').concat(r,"</span>"):void 0},S=function(e){var a=(+e).toLocaleString("ru-RU"),t=a.split(/[,]/);return void 0!==t[1]&&1===t[1].length?"".concat(a.replace(",","."),"0"):"".concat(a.replace(",","."))},k={transition:"opacity ".concat(100,"ms ease-in-out"),height:0,opacity:0,overflow:"hidden"},C={entering:{opacity:0,height:0},entered:{opacity:1,height:"100%"},exiting:{opacity:1,height:"100%"},exited:{opacity:0,height:0}},q=function(e){var a=e.items,t=e.lenders,l=e.borrowers,c=e.onOpenModal,s=e.setCurrentRepay,u=Object(n.useState)([]),o=Object(f.a)(u,2),m=o[0],i=o[1],p=Object(n.useState)([]),b=Object(f.a)(p,2),_=b[0],E=b[1],v=Object(n.useState)(!1),O=Object(f.a)(v,2),j=O[0],h=O[1];Object(n.useEffect)((function(){if(void 0!==t&&t.length>0)return i(Object(x.a)(t)),void h(!0);void 0!==l&&l.length>0&&(i(Object(x.a)(l)),h(!1))}),[t,l]),Object(n.useEffect)((function(){var e=a.map((function(){return!1}));E(Object(x.a)(e))}),[a]);var N=function(e){var a=Object(x.a)(_);a[e]=!a[e],E(Object(x.a)(a))};return r.a.createElement("ul",{className:"expense-details__list"},a.map((function(e,t){return r.a.createElement("li",{key:t,className:"expense-details__list-item ".concat(_[t]?"expense-details__list-item--open":"")},r.a.createElement("div",{className:"expense-details__item-outer",onClick:function(){return N(t)}},r.a.createElement("div",{className:"expense-details__item-name"},e.name),r.a.createElement("div",{className:"expense-details__item-sum"},S(e.sum)),r.a.createElement("div",{className:"expense-details__btn-more"},r.a.createElement("button",{className:"btn btn--text",onClick:function(){return N(t)}},_[t]?"\u0421\u043a\u0440\u044b\u0442\u044c":"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0435\u0435"))),r.a.createElement(g.c,{in:_[t],timeout:100},(function(n){return r.a.createElement("div",{style:Object(d.a)({},k,{},C[n]),className:"expense-details__item-info"},r.a.createElement("div",{className:"expense-details__sub-list-outer"},j?"\u041a\u043e\u043c\u0443 \u0432\u0435\u0440\u043d\u0443\u0442\u044c:":"\u041a\u0442\u043e \u043e\u0434\u043e\u043b\u0436\u0438\u043b:"),r.a.createElement("ul",{className:"expense-details__sub-list"},m.map((function(n,l){return r.a.createElement("li",{key:l,className:"expense-details__sub-item"},r.a.createElement("div",{className:"expense-details__sub-item-name"},n.name),r.a.createElement("div",{className:"expense-details__sub-item-sum"},function(e,a,t,n){if(j){if(n.sum>=a.sum)return;return n.sum}return a.sum>=n.sum?n.sum:a.sum}(0,e,0,n)),r.a.createElement("div",{className:"expense-details__btn-payback"},r.a.createElement("button",{className:"btn btn--text",onClick:function(e){return function(e,t,n){var r=null,l=null;j?(r=a[t],l=m[n]):(r=m[n],l=a[t]),s({currentBorrower:r,currentLender:l}),c(e)}(e,t,l)}},"\u0420\u0430\u0441\u0447\u0435\u0442")))}))))})))})))},P=function(){var e=Object(n.useContext)(h),a=O(),t=E(),l=t.loading,c=t.request,s=t.error,u=t.clearError,o=Object(n.useState)({email:"",password:"",name:""}),m=Object(f.a)(o,2),i=m[0],_=m[1];Object(n.useEffect)((function(){a(s,"error"),u()}),[s,a,u]);var v=function(e){_(Object(d.a)({},i,Object(b.a)({},e.target.name,e.target.value)))},j=function(){var a;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(c("/api/auth/login","POST",Object(d.a)({},i)));case 3:a=t.sent,e.login(a.token,a.userId),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),null,null,[[0,7]])};return r.a.createElement("div",{className:"auth-page"},r.a.createElement("div",{className:"auth-page__content"},r.a.createElement("h1",{className:"auth-page__title"},"I OWE YOU"),r.a.createElement("form",{className:"form auth-page__form",noValidate:!0,autoComplete:"off"},r.a.createElement(N.d,{className:"expense-details__tabs"},r.a.createElement(N.b,{className:"expense-details__tabs-list"},r.a.createElement(N.a,{className:"expense-details__tab"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement(N.a,{className:"expense-details__tab"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")),r.a.createElement(N.c,{className:"auth-page__tab-content"},r.a.createElement("div",{className:"form__title"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:"form__group"},r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",autoComplete:"off",id:"email",type:"email",name:"email",className:"form__input",value:i.email,onChange:v}),r.a.createElement("label",{htmlFor:"email",className:"form__label"},"Email")),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",autoComplete:"new-password",id:"password",type:"password",name:"password",className:"form__input",value:i.password,onChange:v}),r.a.createElement("label",{htmlFor:"email",className:"form__label"},"\u041f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"form__btn-group"},r.a.createElement("div",{className:"form__btn-row"},r.a.createElement("button",{className:"btn form__btn",disabled:l,onClick:j},"\u0412\u043e\u0439\u0442\u0438"))))),r.a.createElement(N.c,{className:"auth-page__tab-content"},r.a.createElement("div",{className:"form__title"},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),r.a.createElement("div",{className:"form__group"},r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{className:"form__input",placeholder:" ",type:"text",name:"name",value:i.name,onChange:v}),r.a.createElement("label",{className:"form__label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f")),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",autoComplete:"off",id:"email",type:"email",name:"email",className:"form__input",value:i.email,onChange:v}),r.a.createElement("label",{htmlFor:"email",className:"form__label"},"Email")),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",autoComplete:"new-password",id:"password",type:"password",name:"password",className:"form__input",value:i.password,onChange:v}),r.a.createElement("label",{htmlFor:"password",className:"form__label"},"\u041f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",id:"password2",type:"password",name:"password2",className:"form__input"}),r.a.createElement("label",{htmlFor:"password2",className:"form__label"},"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")),r.a.createElement("div",{className:"form__btn-group"},r.a.createElement("div",{className:"form__btn-row"},r.a.createElement("button",{className:"btn form__btn",onClick:function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(c("/api/auth/register","POST",Object(d.a)({},i)));case 3:return e=t.sent,a(e.message),t.next=7,p.a.awrap(j());case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),null,null,[[0,9]])},disabled:l},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))))))))},L=function(){var e=Object(n.useState)(""),a=Object(f.a)(e,2),t=a[0],l=a[1],c=E().request,s=Object(n.useContext)(h).token,o=O(),m=Object(u.g)();return r.a.createElement("div",{className:"journey-create"},r.a.createElement("form",{className:"form journey-create__form",noValidate:!0},r.a.createElement("h1",{className:"form__title"},"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u0435\u0437\u0434\u043a\u0438"),r.a.createElement("div",{className:"form__group"},r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",className:"form__input",type:"text",value:t,onChange:function(e){return l(e.target.value)}}),r.a.createElement("label",{className:"form__label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u0435\u0437\u0434\u043a\u0438"))),r.a.createElement("a",{href:"#",className:"form__btn",onClick:function(e){var a;return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.a.awrap(c("/api/journey/create","POST",{title:t},{Authorization:"Bearer ".concat(s)}));case 3:a=e.sent,m.push("/journey/details"),o(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),o(e.t0.message,"error");case 11:case"end":return e.stop()}}),null,null,[[0,8]])}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))},A=t(37),M=t.n(A),B=function(){return r.a.createElement(M.a,{className:"app__loader",type:"TailSpin",color:"#ffffff",height:100,width:100})},T=t(29),D=t.n(T),I={content:{top:"0",left:"0",right:"0",bottom:"0",marginRight:"0"}};D.a.setAppElement("#root");var z=function(e){var a=e.children,t=e.isOpen,n=e.onClose,l=e.onAfterCloseModal;return r.a.createElement(D.a,{isOpen:t,onAfterClose:l,onRequestClose:n,style:I,contentLabel:"Example Modal",closeTimeoutMS:600,className:"app-modal",bodyOpenClassName:"body--modal-open"},a)},R=("transform ".concat(300,"ms ease-in-out"),"transform ".concat(300,"ms ease-in-out"),function(e){var a=e.onChangeTitle,t=e.title,n=e.onChangeAmount,l=e.amount;return r.a.createElement("div",{className:"form__group"},r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{className:"form__input",placeholder:" ",type:"text",value:t,onChange:a}),r.a.createElement("label",{className:"form__label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u043f\u043b\u0430\u0442\u044b")),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{className:"form__input",placeholder:" ",type:"number",inputMode:"decimal",value:l,onChange:n}),r.a.createElement("label",{className:"form__label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u043e\u043f\u043b\u0430\u0442\u044b")))}),F=function(e){var a=e.openEqualPayersModal,t=e.openUnequalPayersModal,n=e.payersStatus,l=e.splitStatus;return r.a.createElement("div",{className:"new-expense__status-info"},r.a.createElement("div",{className:"new-expense__block"},r.a.createElement("span",null,"\u041a\u0442\u043e \u043f\u043b\u0430\u0442\u0438\u0442?"),r.a.createElement("button",{className:"btn btn--text new-expense__text-btn",onClick:a},r.a.createElement("span",null,n))),r.a.createElement("div",{className:"new-expense__block"},r.a.createElement("span",null,"\u041a\u0430\u043a \u0434\u0435\u043b\u0438\u043c?"),r.a.createElement("button",{className:"btn btn--text new-expense__text-btn",onClick:t},r.a.createElement("span",null,l))))},G=function(e){var a=e.payers,t=e.title,l=e.amount,c=E().request,s=O(),o=Object(n.useContext)(h).token,m=Object(u.g)();return r.a.createElement("div",{className:"form__btn-group"},r.a.createElement("a",{href:"#",className:"form__btn",onClick:function(){var e,n,r;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return e=a.reduce((function(e,a){var t=a.name,n=a.sum,r=!0===a.isLender?"lenders":"borrowers";return 0===n?e:(e[r]=[].concat(Object(x.a)(e[r]),[{name:t,sum:n}]),e)}),{lenders:[],borrowers:[]}),n=function(){return 0===e.lenders.length||0===e.borrowers.length?{lenders:[],borrowers:[]}:e},u.prev=2,u.next=5,p.a.awrap(c("/api/expense/create","POST",Object(d.a)({title:t,amount:l},n()),{Authorization:"Bearer ".concat(o)}));case 5:r=u.sent,m.push("/expense/list"),s(r.message),u.next=13;break;case 10:u.prev=10,u.t0=u.catch(2),s(u.t0.message,"error");case 13:case"end":return u.stop()}}),null,null,[[2,10]])}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},H=function(e){var a=e.payers,t=e.amount,l=e.notPayers,c=e.setNotPayers,s=e.closeModal,u=e.setPayers,o=e.setSplitStatus,m=e.payersAmount,i=e.setPayersAmount,p=Object(n.useState)(0),_=Object(f.a)(p,2),E=_[0],v=_[1];Object(n.useEffect)((function(){if(!(Object.keys(m).length<=0)){o(function(){var e=0,t="\u041f\u043e\u0440\u043e\u0432\u043d\u0443";return a.forEach((function(a,n){0===n&&(e=a.sum),e!==a.sum&&(t="\u041d\u0435 \u043f\u043e\u0440\u043e\u0432\u043d\u0443")})),t}())}}),[a]),Object(n.useEffect)((function(){var e=Object.keys(m).reduce((function(e,a){return e+m[a]}),0);v(e)}),[m]);var O=function(e){e.preventDefault(),i(Object(d.a)({},m,Object(b.a)({},e.target.name,+e.target.value)))},j=function(e){c(Object(d.a)({},l,Object(b.a)({},e.target.name,!e.target.checked)))};return r.a.createElement("div",{className:"expense-fill"},r.a.createElement("div",{className:"header"},r.a.createElement("a",{className:"header__btn-save",onClick:function(e){var n=+t;if(E>n)alert("\u0421\u0443\u043c\u043c\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430 \u043d\u0435\u0432\u0435\u0440\u043d\u043e. \u0412\u0432\u0435\u0434\u0435\u043d\u043e \u043d\u0430 ".concat(E-n," \u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u043e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u043e\u043f\u043b\u0430\u0442\u044b: ").concat(n));else if(E<n)alert("\u0421\u0443\u043c\u043c\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430 \u043d\u0435\u0432\u0435\u0440\u043d\u043e. \u0412\u0432\u0435\u0434\u0435\u043d\u043e \u043d\u0430 ".concat(n-E," \u043c\u0435\u043d\u044c\u0448\u0435, \u0447\u0435\u043c \u043e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u043e\u043f\u043b\u0430\u0442\u044b: ").concat(n));else{var r=Object.keys(l).reduce((function(e,a){return e+ +l[a]}),0),c=r>0?n/(a.length-r):n/a.length,o=a.map((function(e){return Object(d.a)({},e,{},function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return!0===l[e.name]?0===a?{isLender:!1,isPayer:!1,sum:0}:{isLender:!0,isPayer:!1,sum:Math.round(100*a)/100}:a>c?{isLender:!0,isPayer:!0,sum:Math.round(100*(a-c))/100}:a<c?{isLender:!1,isPayer:!0,sum:Math.round(100*(c-a))/100}:{isLender:!1,isPayer:!0,sum:0}}(m[e.name]))}));u(Object(x.a)(o)),s(e)}}},r.a.createElement("span",null,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")),r.a.createElement("div",{className:"header__title"},"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443"),r.a.createElement("a",{className:"header__btn-close",onClick:s},r.a.createElement("span",null,"\xd7"))),r.a.createElement("div",{className:"expense-fill__content"},r.a.createElement("form",{className:"expense-fill__form"},a.length&&a.map((function(e){return r.a.createElement("div",{className:"expense-fill__item",key:e.name},r.a.createElement("span",{className:"expense-fill__name"},e.name),r.a.createElement("label",{className:"checkbox-switcher"},r.a.createElement("input",{type:"checkbox",name:e.name,defaultChecked:!l[e.name]||!1===l[e.name],onChange:j}),r.a.createElement("span",{className:"track thumb"})),r.a.createElement("div",{className:"expense-fill__input-row"},r.a.createElement("span",null,"\u20b4"),r.a.createElement("input",{type:"number",inputMode:"decimal",placeholder:"0.00",name:e.name,className:"form__input",value:m[e.name]?m[e.name]:"",onChange:O})))}))),r.a.createElement("div",{className:"expense-fill__footer"},r.a.createElement("div",{className:"expense-fill__calculation"},r.a.createElement("div",null,E," \u0438\u0437 ",r.a.createElement("span",null,t)),r.a.createElement("div",null,"\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c:",r.a.createElement("span",{className:E<=t?"expense-fill__correct":"expense-fill__wrong"}," ".concat(t-E)))))))},J=t(39),U=t(19),V=function(e){var a=e.amount,t=e.payers,l=e.setPayers,c=e.closeModal,s=Object(n.useState)({unequalPayers:[],totalBillAmount:0,totalPayAmount:0}),u=Object(f.a)(s,2),o=u[0],m=u[1],i=Object(n.useState)(!1),p=Object(f.a)(i,2),_=p[0],E=p[1],v=Object(n.useState)(!1),O=Object(f.a)(v,2),j=O[0],h=O[1],N=Object(n.useState)([]),g=Object(f.a)(N,2),y=g[0],w=g[1],S=Object(n.useState)(!1),k=Object(f.a)(S,2),C=k[0],q=k[1],P=Object(n.useState)(""),L=Object(f.a)(P,2),A=L[0],M=L[1],B=Object(n.useState)({}),T=Object(f.a)(B,2),D=T[0],I=T[1],z=Object(n.useState)(""),R=Object(f.a)(z,2),F=R[0],G=R[1],H=Object(n.useState)(""),V=Object(f.a)(H,2),W=V[0],Y=V[1],$=Object(n.useState)({}),K=Object(f.a)($,2),Q=K[0],X=K[1],Z=Object(n.useState)({}),ee=Object(f.a)(Z,2),ae=ee[0],te=ee[1];Object(n.useEffect)((function(){var e=t.map((function(e){return{name:e.name,billSum:"",paySum:"",isLoaner:!1,personalLender:{}}}));!1===_&&m(Object(d.a)({},o,{unequalPayers:e}))}),[t,_]),Object(n.useEffect)((function(){if(!1!==j&&0!==o.unequalPayers.length){var e=o.unequalPayers.reduce((function(e,a){return+a.paySum>+a.billSum?[].concat(Object(x.a)(e),[{value:a.name,label:a.name}]):e}),[]);if(1===e.length){var a=o.unequalPayers.map((function(a){var t=e[0].value;return+a.billSum>+a.paySum?Object(d.a)({},a,{personalLender:Object(b.a)({},t,+a.billSum-+a.paySum)}):a}));m(Object(d.a)({},o,{unequalPayers:a}))}w(e)}}),[j]),Object(n.useEffect)((function(){if(0!==Object.keys(Q).length){var e=Object.keys(Q).reduce((function(e,a){var t=Object.keys(Q[a]).map((function(e){return{name:e,sum:Q[a][e]}}));return Object(d.a)({},e,Object(b.a)({},a,t))}),{});te(e)}}),[Q]);var ne=function(e){var t=o.unequalPayers.some((function(a){return!!+a[e]})),n="billSum"===e?o.totalBillAmount:o.totalPayAmount;return!1===t?(alert("\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u0430\u043a \u043c\u0438\u043d\u0438\u043c\u0443\u043c \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430"),!1):n<a?(alert("\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0441\u0443\u043c\u043c\u044b \u043d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043a\u0440\u044b\u0442\u044c \u0440\u0430\u0441\u0445\u043e\u0434\u044b"),!1):!(n>a)||(alert("\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u0431\u043e\u043b\u044c\u0448\u0435, \u0447\u0435\u043c \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u043f\u043b\u0430\u0442\u044b"),!1)},re=function(e){var a=e.target,t=a.value,n=a.name,r=_?"paySum":"billSum",l=_?"totalPayAmount":"totalBillAmount",c=o.unequalPayers.map((function(e){return n===e.name?Object(d.a)({},e,Object(b.a)({},r,t)):e})),s=c.reduce((function(e,a){return e+ +a[r]}),0);m(Object(d.a)({},o,Object(b.a)({unequalPayers:c},l,s)))},le=function(){var e={},a=null;o.unequalPayers.filter((function(t){t.name===F&&(a=t),!0===t.isLoaner&&Object.keys(t.personalLender).filter((function(a){e[a]=void 0!==e[a]?+e[a]+ +t.personalLender[a]:+t.personalLender[a]}))}));var t=+a.paySum-+a.billSum;if(t<+A)alert("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0441\u0440\u0435\u0434\u0441\u0442\u0432 \u0443 \u0437\u0430\u0435\u043c\u0449\u0438\u043a\u0430, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043a\u0440\u044b\u0442\u044c \u044d\u0442\u043e\u0442 \u0440\u0430\u0441\u0445\u043e\u0434");else if(void 0!==e[F]&&+A>+e[F]-t)alert("\u0417\u0430\u0435\u043c\u0449\u0438\u043a\u0443 \u0443\u0436\u0435 \u0434\u0430\u043b \u0432\u0437\u0430\u0439\u043c\u044b \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e.");else{var n=Object(b.a)({},W,Object(b.a)({},F,A));X(Object(d.a)({},Q,Object(b.a)({},W,Object(d.a)({},Q[W],{},n[W]))));var r=o.unequalPayers.map((function(e){return void 0!==n[e.name]?Object(d.a)({},e,{personalLender:Object(d.a)({},e.personalLender,{},n[e.name])}):e}));m(Object(d.a)({},o,{unequalPayers:r})),ce()}},ce=function(){q(!1)},se=function(e,a){var t=function(e){return+e},n=null===e?"":e.value;G(n),Y(a);var r=[e.value],l=Object(d.a)({},D,Object(b.a)({},a,Object(b.a)({},r[0],0)));if(I(l),(void 0===D[a]?0:Object.keys(D[a]).length)<=Object.keys(l[a]).length){var c=o.unequalPayers.find((function(e){return e.name===n})),s=o.unequalPayers.find((function(e){return e.name===a}));M(function(){var e=t(c.billSum),a=t(c.paySum)-e,n=t(s.billSum)-t(s.paySum);return"".concat(a>=n?n:a)}()),q(!0)}else{var u=o.unequalPayers.map((function(e){var t={},n=function(e){return r.forEach((function(a){Object.keys(e).forEach((function(n){a===n&&(t[n]=e[n])}))})),t};return a===e.name?(X(Object(d.a)({},Q,Object(b.a)({},e.name,n(e.personalLender)))),Object(d.a)({},e,{personalLender:n(e.personalLender)})):e}));m(Object(d.a)({},o,{unequalPayers:u}))}};return r.a.createElement("div",{className:"expense-unequal"},r.a.createElement("div",{className:"header"},r.a.createElement("a",{className:"header__btn-save"},r.a.createElement("span",null,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")),r.a.createElement("div",{className:"header__title"},"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443"),r.a.createElement("a",{className:"header__btn-close",onClick:c},r.a.createElement("span",null,"\xd7"))),r.a.createElement("div",{className:"expense-unequal__hint"},!1===_?"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0432 \u0447\u0435\u043a\u0435. \u041e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u043e\u043b\u0435 \u043f\u0443\u0441\u0442\u044b\u043c, \u0435\u0441\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u043b \u0432 \u043e\u043f\u043b\u0430\u0442\u0435.":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0432\u044b \u0433\u043e\u0442\u043e\u0432\u044b \u0437\u0430\u043f\u043b\u0430\u0442\u0438\u0442\u044c. \u0418\u043b\u0438 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0432\u0432\u043e\u0434\u0438\u0442\u0435, \u0435\u0441\u043b\u0438 \u0437\u0430\u043f\u043b\u0430\u0442\u0438\u0442\u0435 \u043f\u043e\u0437\u0436\u0435",r.a.createElement("div",{className:"expense-unequal__amount"},r.a.createElement("div",null,!1===_?o.totalBillAmount:o.totalPayAmount," \u0438\u0437 ",a),r.a.createElement("div",null,"\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c: ",a-(!1===_?o.totalBillAmount:o.totalPayAmount)))),r.a.createElement("div",{className:"expense-unequal__content"},!1===_&&r.a.createElement("ul",{className:"expense-unequal__list-bill"},o.unequalPayers.map((function(e,a){return r.a.createElement("li",{key:a},r.a.createElement("div",{className:"expense-unequal__inner-panel"},r.a.createElement("div",{className:"expense-unequal__name"},e.name),r.a.createElement("div",{className:"expense-unequal__bill-value"},r.a.createElement("input",{className:"input",type:"number",placeholder:"0.00",name:e.name,value:e.billSum?e.billSum:"",onChange:re}))))}))),!0===_&&r.a.createElement("ul",{className:"expense-unequal__list-pay"},o.unequalPayers.map((function(e,a){return r.a.createElement("li",{key:a},r.a.createElement("div",{className:"expense-unequal__inner-panel"},r.a.createElement("div",{className:"expense-unequal__name"},e.name),r.a.createElement("div",{className:"expense-unequal__bill-sum"},"\u0427\u0435\u043a: ",e.billSum),!0===j&&r.a.createElement("span",{className:"expense-unequal__pay-sum"},"\u041e\u043f\u043b\u0430\u0442\u0430: "),r.a.createElement("div",{className:"expense-unequal__pay-value"},r.a.createElement("input",{className:"input expense-unequal__input ".concat(j?"expense-unequal__input--disabled":""),type:"number",placeholder:"0.00",disabled:!0===j,name:e.name,value:e.paySum?e.paySum:"",onChange:re}))),r.a.createElement("div",{className:"expense-unequal__inner-panel"},e.isLoaner&&r.a.createElement("div",{className:"expense-unequal__select-container"},y.length>1?r.a.createElement("div",{className:"expense-unequal__select-box"},r.a.createElement(J.a,{className:"expense-unequal__select",classNamePrefix:"expense-unequal-select",placeholder:"\u041a\u0442\u043e \u0437\u0430 \u0432\u0430\u0441 \u0437\u0430\u043f\u043b\u0430\u0442\u0438\u0442",onChange:function(a){return se(a,e.name)},options:y}),ae[e.name]&&r.a.createElement("span",{className:"expense-unequal__lender-sum"},ae[e.name].map((function(e,a){return r.a.createElement("span",{key:a},e.name," \u0434\u0430\u0435\u0442 \u0432\u0437\u0430\u0439\u043c\u044b ",e.sum)})))):r.a.createElement("div",{className:"expense-unequal__select-single"},void 0!==y[0]?"\u0417\u0430 \u0412\u0430\u0441 \u043f\u043b\u0430\u0442\u0438\u0442: ".concat(y[0].label):""))))})))),r.a.createElement("div",{className:"expense-unequal__control"},_&&r.a.createElement("button",{className:"btn btn--text",onClick:function(){if(!0===j)return m(Object(d.a)({},o,{unequalPayers:Object(x.a)(o.unequalPayers.map((function(e){return Object(d.a)({},e,{isLoaner:!1})})))})),I({}),void h(!1);E(!1)}},"\u041d\u0430\u0437\u0430\u0434"),!_&&r.a.createElement("button",{className:"btn btn--text",onClick:function(){!1!==ne("billSum")&&(m(Object(d.a)({},o,{unequalPayers:o.unequalPayers.filter((function(e){return!!+e.billSum}))})),E(!0))}},"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),_&&!j&&r.a.createElement("button",{className:"btn btn--text",onClick:function(){if(!1!==ne("paySum")){var e=o.unequalPayers.map((function(e){var a=+e.billSum;return+e.paySum<a?Object(d.a)({},e,{isLoaner:!0}):e}));m(Object(d.a)({},o,{unequalPayers:e})),h(!0)}}},"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"),j&&r.a.createElement("button",{className:"btn btn--text",onClick:function(e){var a=!0,t=o.unequalPayers;if(t.forEach((function(e){if(+e.billSum>+e.paySum){var t=Object.keys(e.personalLender).reduce((function(a,t){return a+ +e.personalLender[t]}),0);+e.billSum!==t+ +e.paySum&&(a=!1)}})),!1!==a){var n=t.map((function(e){return{name:e.name,isLender:!e.isLoaner,isPayer:!0,sum:e.isLoaner?+e.billSum:+e.paySum-+e.billSum,personalLender:e.personalLender}}));l(n),c(e)}else alert("\u0414\u0430\u043d\u043d\u044b\u0435 \u043e \u043f\u043b\u0430\u0442\u0435\u0436\u0435 \u0432\u0432\u0435\u0434\u0435\u043d\u044b \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437")}},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")),r.a.createElement(U.a,{show:C,onHide:le},r.a.createElement(U.a.Header,{closeButton:!0},r.a.createElement(U.a.Title,null,"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443")),r.a.createElement(U.a.Body,null,r.a.createElement("input",{className:"input",type:"number",placeholder:"0.00",value:A,name:"personal-sum",onChange:function(e){var a=e.target.value;M(a)}})),r.a.createElement(U.a.Footer,null,r.a.createElement("button",{className:"btn btn--text",onClick:le},"Close"),r.a.createElement("button",{className:"btn btn--text",onClick:le},"Save Changes"))))},W=function(){var e=Object(n.useState)(""),a=Object(f.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(""),u=Object(f.a)(c,2),o=u[0],m=u[1],i=Object(n.useState)([]),_=Object(f.a)(i,2),v=_[0],j=_[1],N=Object(n.useState)(""),g=Object(f.a)(N,2),y=g[0],w=g[1],S=Object(n.useState)(!1),k=Object(f.a)(S,2),C=k[0],q=k[1],P=Object(n.useState)(!1),L=Object(f.a)(P,2),A=L[0],M=L[1],T=Object(n.useState)([]),D=Object(f.a)(T,2),I=D[0],J=D[1],U=Object(n.useState)(""),W=Object(f.a)(U,2),Y=W[0],$=W[1],K=Object(n.useState)("\u041f\u043e\u0440\u043e\u0432\u043d\u0443"),Q=Object(f.a)(K,2),X=Q[0],Z=Q[1],ee=Object(n.useState)(0),ae=Object(f.a)(ee,2),te=(ae[0],ae[1]),ne=Object(n.useState)({}),re=Object(f.a)(ne,2),le=re[0],ce=re[1],se=Object(n.useState)({}),ue=Object(f.a)(se,2),oe=ue[0],me=ue[1],ie=Object(n.useState)(!0),pe=Object(f.a)(ie,2),be=(pe[0],pe[1]),de=E(),fe=de.request,_e=de.loading,Ee=Object(n.useContext)(h),ve=Ee.token,Oe=Ee.userId,je=O(),he=function(e){e.preventDefault(),o<=0?je("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u043e\u043f\u043b\u0430\u0442\u044b","info"):q(!0)},Ne=function(e){e.preventDefault(),o<=0?je("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u043e\u043f\u043b\u0430\u0442\u044b","info"):M(!0)},xe=function(e){e.preventDefault(),q(!1)},ge=function(e){e.preventDefault(),M(!1)},ye=Object(n.useCallback)((function(){var e;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(fe("/api/users","GET",null,{Authorization:"Bearer ".concat(ve)}));case 3:e=a.sent,j(e),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),je(a.t0.message,"error");case 10:case"end":return a.stop()}}),null,null,[[0,7]])}),[ve,fe]);Object(n.useEffect)((function(){ye()}),[]),Object(n.useEffect)((function(){if(!(v.length<=0)){var e=v.find((function(e){return e._id===Oe}));e&&(w(e.name),$(e.name))}}),[v]),Object(n.useEffect)((function(){if(!(v.length<=0)){var e=v.reduce((function(e,a){return e=Object(d.a)({},e,Object(b.a)({},a.name,!1))}),{});me(Object(d.a)({},e))}}),[v]),Object(n.useEffect)((function(){var e=v.map((function(e){return{name:e.name,isLender:e.name===y,sum:0}}));J(Object(x.a)(e))}),[v,y]),Object(n.useEffect)((function(){if(!(I.length<=0)){var e=I.filter((function(e){return e.isLender}));if(!(e.length<=0)){$(e.length>1?"".concat(e.length," \u0447\u0435\u043b."):e[0].name===y?"".concat(e[0].name,"(\u0412\u044b)"):e[0].name),te(e.length)}}}),[I,oe]);return Object(n.useEffect)((function(){J(Object(x.a)(function(e){var a=+o/I.length,t=e.reduce((function(e,a){var t=!0===a.isLender?"lenders":"borrowers";return e[t]=[].concat(Object(x.a)(e[t]),[a]),e}),{lenders:[],borrowers:[]}),n=t.lenders,r=t.borrowers,l=Math.round(a*r.length/n.length*100)/100,c=Math.round(l*n.length/r.length*100)/100;return e.map((function(e){var t=e.name,n=e.isLender&&a<=l;return{name:t,isLender:n,sum:n?l:c}}))}(I)))}),[o]),_e?r.a.createElement(B,null):r.a.createElement("div",{className:"new-expense"},r.a.createElement("div",{className:"header"},r.a.createElement(s.b,{className:"header__btn-back",to:"/expense/list"},r.a.createElement("span",null,"\u276e")),r.a.createElement("div",{className:"header__title"},"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430")),r.a.createElement("form",{className:"new-expense__form form"},r.a.createElement("div",{className:"form__title"},"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0438 \u0441\u0443\u043c\u043c\u0443 \u043d\u043e\u0432\u043e\u0439 \u043e\u043f\u043b\u0430\u0442\u044b:"),r.a.createElement(R,{title:t,amount:o,onChangeTitle:function(e){return l(e.target.value)},onChangeAmount:function(e){return m(e.target.value)}}),r.a.createElement(F,{openEqualPayersModal:he,openUnequalPayersModal:Ne,payersStatus:Y,splitStatus:X}),r.a.createElement(G,{payers:I,title:t,amount:o})),r.a.createElement(z,{onOpen:he,onClose:xe,isOpen:C,onAfterCloseModal:function(){return be(!0)}},r.a.createElement(V,{amount:o,payers:I,setPayers:J,closeModal:xe})),r.a.createElement(z,{onOpen:Ne,onClose:ge,isOpen:A},r.a.createElement(H,{payers:I,notPayers:oe,amount:o,payersAmount:le,setPayers:J,setNotPayers:me,setPayersAmount:ce,setSplitStatus:Z,closeModal:ge})))},Y=function(){var e=Object(n.useState)([]),a=Object(f.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(""),s=Object(f.a)(c,2),o=s[0],m=s[1],i=Object(n.useState)(""),b=Object(f.a)(i,2),d=b[0],_=b[1],v=Object(u.g)(),j=O(),N=Object(n.useContext)(h).token,g=E(),y=g.loading,w=g.request,S=Object(n.useCallback)((function(){var e;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(w("/api/users/author","GET",null,{Authorization:"Bearer ".concat(N)}));case 3:e=a.sent,_(e),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),j(a.t0.message,"error");case 10:case"end":return a.stop()}}),null,null,[[0,7]])}),[N,w]);Object(n.useEffect)((function(){S()}),[S]);return y?r.a.createElement(B,null):r.a.createElement("div",{className:"journey-details"},r.a.createElement("div",{className:"journey-details__content"},r.a.createElement("h1",{className:"journey-details__title"},"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"),r.a.createElement("form",{noValidate:!0,className:"form journey-details__form"},r.a.createElement("div",{className:"form__title"},"\u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043c \u0432\u0441\u0435\u0445 \u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432 \u043c\u0435\u0436\u0434\u0443 \u043a\u043e\u0442\u043e\u0440\u044b\u043c\u0438 \u0434\u0435\u043b\u0438\u043c \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430"),r.a.createElement("ul",{className:"journey-details__user-list"},d&&r.a.createElement("li",{className:"journey-details__user"},r.a.createElement("span",null,"\ud83d\udc51 ",d)),t.length>0&&t.map((function(e,a){return r.a.createElement("li",{key:a,className:"journey-details__user"},r.a.createElement("span",{className:"journey-details__user-name"},e),r.a.createElement("a",{className:"journey-details__user-remove",href:"#",onClick:function(){return function(e){var a=Object(x.a)(t);a.splice(e,1),l(a)}(a)}},"\u2716\ufe0e"))}))),r.a.createElement("div",{className:"form__row"},r.a.createElement("input",{placeholder:" ",type:"text",value:o,className:"form__input",onChange:function(e){return(a=e).preventDefault(),void m(a.target.value);var a}}),r.a.createElement("label",{className:"form__label"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f")),r.a.createElement("div",{className:"form__btn-group"},r.a.createElement("div",{className:"form__btn-row"},r.a.createElement("button",{className:"form__btn form__btn--white ",onClick:function(e){return e.preventDefault(),void(o.length<=0?j("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f","error"):(l([].concat(Object(x.a)(t),[o])),m("")))}},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c")),r.a.createElement("div",{className:"form__btn-row"},r.a.createElement("button",{className:"form__btn",onClick:function(e){return function(e){var a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.prev=1,n.next=4,p.a.awrap(w("/api/journey/users/add","POST",{users:t},{Authorization:"Bearer ".concat(N)}));case 4:a=n.sent,j(a.message),v.push("/expense"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),j(n.t0.message,"error");case 12:case"end":return n.stop()}}),null,null,[[1,9]])}(e)},disabled:t.length<=0},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))))},$=function(e){var a=e.visibleExpenses,t=e.currentName;return r.a.createElement("ul",{className:"expenses-page__list"},a.map((function(e){return r.a.createElement("li",{key:e._id,className:"expenses-page__list-item"},r.a.createElement(s.b,{to:"/expense/".concat(e._id),className:"expenses-page__item-content"},r.a.createElement("div",{className:"expenses-page__item-time",dangerouslySetInnerHTML:{__html:w(e.createdAt,"dm")}}),r.a.createElement("div",{className:"expenses-page__item-info"},r.a.createElement("div",{className:"expenses-page__info-top"},r.a.createElement("div",{className:"expenses-page__item-title"},r.a.createElement("span",null,e.title)),r.a.createElement("div",{className:"expenses-page__item-amount"},"\u0414\u043e\u043b\u0433: ",S(e.borrowers.reduce((function(e,a){return"all"===t?e+a.sum:a.name===t?e+a.sum:e}),0)))),r.a.createElement("div",{className:"expenses-page__info-bottom"},"\u0421\u0443\u043c\u043c\u0430 \u043e\u043f\u043b\u0430\u0442\u044b: ",S(e.amount))),r.a.createElement("div",{className:"expenses-page__item-open"},"\u276f")))})))},K=function(){var e=Object(n.useContext)(h),a=e.token,t=e.logout,l=E(),c=l.request,o=l.loading,m=Object(n.useState)([]),i=Object(f.a)(m,2),b=i[0],_=i[1],v=Object(n.useState)([]),j=Object(f.a)(v,2),N=j[0],g=j[1],y=Object(n.useState)([]),k=Object(f.a)(y,2),C=k[0],q=k[1],P=Object(n.useState)("all"),L=Object(f.a)(P,2),A=L[0],M=L[1],T=Object(n.useState)({}),D=Object(f.a)(T,2),I=D[0],z=D[1],R=Object(n.useState)(0),F=Object(f.a)(R,2),G=F[0],H=F[1],J=O(),U=Object(u.g)(),V=Object(n.useCallback)((function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(c("/api/expense/list","GET",null,{Authorization:"Bearer ".concat(a)}));case 3:e=t.sent,_(Object(x.a)(e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),J(t.t0.message,"error");case 10:case"end":return t.stop()}}),null,null,[[0,7]])}),[a,c]),W=Object(n.useCallback)((function(){var e,t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.a.awrap(c("/api/users","GET",null,{Authorization:"Bearer ".concat(a)}));case 3:e=n.sent,t=e.map((function(e){return e.name})),q(Object(x.a)(t)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),J(n.t0.message,"error");case 11:case"end":return n.stop()}}),null,null,[[0,8]])}),[a,c]),Y=Object(n.useCallback)((function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.awrap(c("/api/journey","GET",null,{Authorization:"Bearer ".concat(a)}));case 3:null===(e=t.sent)&&U.push("/journey"),z(Object(d.a)({},e)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),J(t.t0.message,"error");case 11:case"end":return t.stop()}}),null,null,[[0,8]])}),[a,c]);Object(n.useEffect)((function(){Y()}),[Y]),Object(n.useEffect)((function(){V()}),[V]),Object(n.useEffect)((function(){W()}),[W]),Object(n.useEffect)((function(){if(!(b.length<=0)){var e=b.filter((function(e){return e.borrowers.length>0}));if("all"!==A){var a=e.filter((function(e){return e.borrowers.some((function(e){return e.name===A}))}));g(Object(x.a)(a))}else g(Object(x.a)(e))}}),[b,A]),Object(n.useEffect)((function(){if(!(b.length<=0)){var e=b.reduce((function(e,a){return e+a.borrowers.reduce((function(e,a){return e+("all"===A?a.sum:(t=a).name===A?t.sum:0);var t}),0)}),0);H(e)}}),[b,A]);return o?r.a.createElement(B,null):r.a.createElement("div",{className:"expenses-page"},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"header__title"},"\u0421\u043f\u0438\u0441\u043e\u043a \u043e\u043f\u043b\u0430\u0442"),r.a.createElement("a",{className:"header__btn-exit",href:"/",onClick:function(e){e.preventDefault(),t(),U.push("/")}},r.a.createElement("span",null,"\u0412\u044b\u0439\u0442\u0438"))),r.a.createElement("div",{className:"expenses-page__brief"},r.a.createElement("div",{className:"expenses-page__journey-title"},I.title),r.a.createElement("div",{className:"expenses-page__expense-info"},r.a.createElement("div",{className:"expenses-page__journey-date"},r.a.createElement("span",{className:"date",dangerouslySetInnerHTML:{__html:w(I.createdAt)}})),r.a.createElement("span",{className:"expenses-page__separator"},"\u2022"),r.a.createElement("div",{className:"expenses-page__users-qty"},r.a.createElement("span",null,C.length," \u0447\u0435\u043b"))),G>0&&r.a.createElement("div",{className:"expenses-page__summary-debt"},"\u0421\u0443\u043c\u043c\u0430 \u0434\u043e\u043b\u0433\u0430 (".concat("all"===A?"\u043e\u0431\u0449\u0430\u044f":A,"):"),r.a.createElement("span",null,S(G)))),r.a.createElement("div",{className:"expenses-page__header"},r.a.createElement("div",{className:"expenses-page__select-box"},r.a.createElement("select",{onChange:function(e){M(e.target.value)}},r.a.createElement("option",{defaultValue:!0,value:"all"},"\u0412\u0441\u0435 \u0440\u0430\u0441\u0445\u043e\u0434\u044b"),C.map((function(e,a){return r.a.createElement("option",{key:a,value:e},"\u0420\u0430\u0441\u0445\u043e\u0434\u044b ",e)})))),r.a.createElement("div",{className:"expenses-page__add-expense"},r.a.createElement(s.b,{className:"btn btn--text",to:"/expense/create"},r.a.createElement("span",null,"+")))),r.a.createElement("div",{className:"expenses-page__body"},N.length>0&&r.a.createElement($,{visibleExpenses:N,currentName:A}),0===N.length&&r.a.createElement("div",{className:"expenses-page__empty-list"},r.a.createElement("div",{className:"expenses-page__empty-info"},r.a.createElement("div",{className:"expenses-page__empty-notice"},r.a.createElement("p",null,"\u0417\u0434\u0435\u0441\u044c \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u0442\u0441\u044f ",r.a.createElement("br",null),"\u0441\u043f\u0438\u0441\u043e\u043a \u0432\u0430\u0448\u0438\u0445 \u043e\u043f\u043b\u0430\u0442."),r.a.createElement("p",null,"\u0414\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043d\u043e\u0432\u043e\u0439 \u043e\u043f\u043b\u0430\u0442\u044b, ",r.a.createElement("br",null),"\u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043d\u0430 ",r.a.createElement("span",null,"+"))),r.a.createElement("div",{className:"expenses-page__angle-arrow"},"\u21b4")))))},Q=function(e){var a=e.borrowers,t=e.lenders,l=e.setBorrowers,c=e.setLenders,s=e.currentRepay,o=e.onCloseModal,m=E(),i=m.request,b=(m.loading,Object(n.useContext)(h).token),_=O(),v=Object(n.useRef)(null),j=(Object(u.g)(),Object(u.h)().id),N=Object(n.useState)({}),g=Object(f.a)(N,2),y=g[0],w=g[1],S=Object(n.useState)({}),k=Object(f.a)(S,2),C=k[0],q=k[1];Object(n.useEffect)((function(){null!==s&&(w(s.currentBorrower),q(s.currentLender))}),[s]),Object(n.useEffect)((function(){void 0!==y.sum&&(v.current.value=C.sum>=y.sum?y.sum:C.sum)}),[y]);return s&&r.a.createElement("div",{className:"settle-up"},r.a.createElement("div",{className:"settle-up__header"},r.a.createElement("div",{className:"settle-up__back-btn"},r.a.createElement("a",{onClick:o},r.a.createElement("span",null,"\u276e"))),r.a.createElement("div",{className:"settle-up__title"},"\u0414\u0435\u0442\u0430\u043b\u0438 \u043e\u043f\u043b\u0430\u0442\u044b")),r.a.createElement("div",{className:"settle-up__content"},r.a.createElement("div",{className:"settle-up__payback-status"},r.a.createElement("p",null,"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ",r.a.createElement("span",null,y.name)," \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e ",r.a.createElement("span",null,C.name),"."),r.a.createElement("p",null,"\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0441\u0443\u043c\u043c\u0443 \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438.")),r.a.createElement("div",{className:"settle-up__payback-widget"},r.a.createElement("div",{className:"settle-up__payback-process"},r.a.createElement("div",{className:"settle-up__payback-from"},y.name),r.a.createElement("div",{className:"settle-up__payback-arrow"},"\u27f6"),r.a.createElement("div",{className:"settle-up__payback-to"},C.name)),r.a.createElement("div",{className:"form settle-up__payback-sum"},r.a.createElement("input",{className:"form__input",type:"number",inputMode:"decimal",placeholder:"0.00",ref:v})),r.a.createElement("div",{className:"settle-up__btn-apply"},r.a.createElement("button",{className:"btn btn--text",onClick:function(e){var n,r,s,u,m;return p.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(e.persist(),!(+(n=+v.current.value)>+y.sum)){f.next=5;break}return alert("\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u0431\u043e\u043b\u044c\u0448\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u043c\u043e\u0439 - ".concat(y.sum)),f.abrupt("return");case 5:return r=y.sum-n,s=C.sum-n,u=a.reduce((function(e,a){return a.name===y.name?r>0?[].concat(Object(x.a)(e),[Object(d.a)({},a,{sum:r})]):e:[].concat(Object(x.a)(e),[a])}),[]),m=t.reduce((function(e,a){return a.name===C.name?s>0?[].concat(Object(x.a)(e),[Object(d.a)({},a,{sum:s})]):e:[].concat(Object(x.a)(e),[a])}),[]),f.prev=9,f.next=12,p.a.awrap(i("/api/expense/update/".concat(j),"POST",{borrowers:Object(x.a)(u),lenders:Object(x.a)(m),repaid:[{name:y.name,sum:v.current.value,payBackTo:C.name}]},{Authorization:"Bearer ".concat(b)}));case 12:f.sent,l(Object(x.a)(u)),c(Object(x.a)(m)),o(e),f.next=21;break;case 18:f.prev=18,f.t0=f.catch(9),_(f.t0.message,"error");case 21:case"end":return f.stop()}}),null,null,[[9,18]])}},"\u041f\u043e\u0434\u0432\u0435\u0440\u0434\u0438\u0442\u044c")))))},X=function(){var e=Object(n.useContext)(h).token,a=E(),t=a.request,l=a.loading,c=Object(u.h)().id,o=Object(u.g)(),m=Object(n.useState)(null),i=Object(f.a)(m,2),b=i[0],d=i[1],_=Object(n.useState)([]),v=Object(f.a)(_,2),O=v[0],j=v[1],g=Object(n.useState)([]),y=Object(f.a)(g,2),S=y[0],k=y[1],C=Object(n.useState)(null),P=Object(f.a)(C,2),L=P[0],A=P[1],M=Object(n.useState)(!1),T=Object(f.a)(M,2),D=T[0],I=T[1],R=Object(n.useCallback)((function(){var a;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.a.awrap(t("/api/expense/".concat(c),"GET",null,{Authorization:"Bearer ".concat(e)}));case 3:if(0!==(a=n.sent).borrowers.length){n.next=7;break}return o.push("/expense/list"),n.abrupt("return");case 7:d(a),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),o.push("/expense/list");case 13:case"end":return n.stop()}}),null,null,[[0,10]])}),[e,c,t]);Object(n.useEffect)((function(){R()}),[R]),Object(n.useEffect)((function(){null!==b&&(j(Object(x.a)(b.borrowers)),k(Object(x.a)(b.lenders)))}),[b]);var F=function(e){e.preventDefault(),I(!0)},G=function(e){e.preventDefault(),I(!1)};return l?r.a.createElement(B,null):b&&r.a.createElement("div",{className:"expense-details"},r.a.createElement("div",{className:"header"},r.a.createElement(s.b,{className:"header__btn-back",to:"/expense/list"},r.a.createElement("span",null,"\u276e")),r.a.createElement("div",{className:"header__title"},"\u0414\u0435\u0442\u0430\u043b\u0438 \u043e\u043f\u043b\u0430\u0442\u044b")),r.a.createElement("div",{className:"expense-details__brief"},r.a.createElement("div",{className:"expense-details__expense-title"},b.title),r.a.createElement("div",{className:"expense-details__expense-amount"},"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c: ",r.a.createElement("span",null,b.amount)),r.a.createElement("div",{className:"expense-details__expense-date"},"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f: ",r.a.createElement("span",{dangerouslySetInnerHTML:{__html:w(b.createdAt)}}))),r.a.createElement("div",{className:"expense-details__content"},r.a.createElement(N.d,{className:"expense-details__tabs"},r.a.createElement(N.b,{className:"expense-details__tabs-list"},r.a.createElement(N.a,{className:"expense-details__tab"},"\u041d\u0435\u0434\u043e\u043f\u043b\u0430\u0442\u0438\u043b\u0438"),r.a.createElement(N.a,{className:"expense-details__tab"},"\u041f\u0435\u0440\u0435\u043f\u043b\u0430\u0442\u0438\u043b\u0438")),r.a.createElement(N.c,{className:"expense-details__tab-content"},r.a.createElement(q,{items:O,lenders:S,onOpenModal:F,setCurrentRepay:A})),r.a.createElement(N.c,{className:"expense-details__tab-content"},r.a.createElement(q,{items:S,borrowers:O,onOpenModal:F,setCurrentRepay:A})))),r.a.createElement(z,{onOpen:F,onClose:G,onAfterCloseModal:function(){0===O.length&&o.push("/expense/list")},isOpen:D},r.a.createElement(Q,{expense:b,borrowers:O,lenders:S,setBorrowers:j,setLenders:k,currentRepay:L,onCloseModal:G})))},Z=function(e){return e?r.a.createElement(u.b,{render:function(e){var a=e.location;return r.a.createElement(o.a,{className:"app__switcher"},r.a.createElement(m.a,{key:a.key,classNames:"app__page-",timeout:300},r.a.createElement(u.d,{location:a},r.a.createElement(u.b,{path:"/journey",exact:!0},r.a.createElement(L,null)),r.a.createElement(u.b,{path:"/expense/create",exact:!0},r.a.createElement(W,null)),r.a.createElement(u.b,{path:"/journey/details",exact:!0},r.a.createElement(Y,null)),r.a.createElement(u.b,{path:"/expense/list",exact:!0},r.a.createElement(K,null)),r.a.createElement(u.b,{path:"/expense/:id"},r.a.createElement(X,null)),r.a.createElement(u.a,{to:"/expense/list"}))))}}):r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/",exact:!0},r.a.createElement(P,null)),r.a.createElement(u.a,{to:"/"}))};var ee=function(){var e=_(),a=e.token,t=e.login,n=e.logout,l=e.userId,c=e.ready,u=e.userName,o=!!a,m=Z(o);return c?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.Provider,{value:{token:a,login:t,logout:n,userId:l,isAuthenticated:o,userName:u}},r.a.createElement(s.a,null,r.a.createElement("div",{className:"app__body"},m))),r.a.createElement(v.a,{hideProgressBar:!0})):r.a.createElement(B,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[41,1,2]]]);
//# sourceMappingURL=main.6aa40877.chunk.js.map